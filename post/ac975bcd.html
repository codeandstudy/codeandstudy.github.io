<!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script></script><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3"><link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222"><meta name="keywords" content="Python,Django,在线教育平台,"><link rel="alternate" href="/atom.xml" title="mtianyan's blog" type="application/atom+xml"><meta name="description" content="小项目不扫何以扫天下   使用Django+Xadmin打造在线教育平台  第三章：通过留言板功能回顾django基础知识通过做一个小留言板，学习django基础知识教程仓库地址1: https://github.com/mtianyan/DjangoGetStarted"><meta name="keywords" content="Python,Django,在线教育平台"><meta property="og:type" content="article"><meta property="og:title" content="强力Django+杀手级Xadmin打造在线教育平台(三)"><meta property="og:url" content="http://blog.mtianyan.cn/post/ac975bcd.html"><meta property="og:site_name" content="mtianyan&#39;s blog"><meta property="og:description" content="小项目不扫何以扫天下   使用Django+Xadmin打造在线教育平台  第三章：通过留言板功能回顾django基础知识通过做一个小留言板，学习django基础知识教程仓库地址1: https://github.com/mtianyan/DjangoGetStarted"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/BKLg4JDJCe.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/3aIIDddEmc.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/lFgLChlhdc.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/Ef2F5Bf7FA.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/3625a0imed.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/k10eEBg357.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/I9255edkaF.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/2043A3KagE.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/IhD2bJDI6K.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/b230j2d65e.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/aFheliD18B.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/ci4AKb7Lb0.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/6Af7m9cI0i.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/JjH1FjmB0i.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/ghebBaKDDa.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/bd7L9HEbB1.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/7L3m4291JK.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/EJHc2DdkK2.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/00e3abbbFJ.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/g8l89KCfam.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/lJKDjik9Cb.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/65Gad4D4l9.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/G60aadGLkJ.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/4mF5KmaCKj.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/gaaL4hlAGj.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/bK273a3j4D.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/l0I7CGB2Be.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/73EjmflBe9.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/ihf44icl9d.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/bCK3e2eF9C.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/7j9GC32b44.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/dbKECKEBFg.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/26GK5BjhCd.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/IA82jEgmAG.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/0HhH9l2B9G.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/0hADe4ggDG.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/IBga4E2FGh.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/FGChlB50k7.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/mAebKF06m9.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/0cb6GGiGDa.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/hJgD3AC3c2.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/Eal2Ldj6e8.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/IChf8L7ecd.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/3b7aeEg0KE.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/m2fF7j38dC.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/bg6ICDcI9I.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/DiBKcaJd8A.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/glha3bHaC8.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/chCamk6JDk.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/3cCBcF96eC.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/3BL02H2ljG.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/c2lIdeH2A1.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/gblC5dg219.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/heblbcAf4h.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/33ECK331eE.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/4Ck700a9Ea.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/i22jKb99Bh.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/0mJgFKbi9k.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/BamdmLI1Ec.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/F60Dl7jf93.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/27BFK0ieIL.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/mhJlLmCiLh.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/Ahch4LBcKd.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/kBb2Ak6ec0.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/5c6fK8mDAK.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/he6fBLk1le.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/ihKmHmCLcD.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/DccKL0EB4C.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/m8jJE8KEae.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/aehl7G2K20.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180107/jm5AJLLmGd.png?imageslim"><meta property="og:updated_time" content="2018-02-02T12:40:13.960Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="强力Django+杀手级Xadmin打造在线教育平台(三)"><meta name="twitter:description" content="小项目不扫何以扫天下   使用Django+Xadmin打造在线教育平台  第三章：通过留言板功能回顾django基础知识通过做一个小留言板，学习django基础知识教程仓库地址1: https://github.com/mtianyan/DjangoGetStarted"><meta name="twitter:image" content="http://myphoto.mtianyan.cn/blog/180106/BKLg4JDJCe.png?imageslim"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"5.1.3",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!0,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://blog.mtianyan.cn/post/ac975bcd.html"><script>!function(e,t,o,c,i,a,n){e.DaoVoiceObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,a=t.createElement("script"),n=t.getElementsByTagName("script")[0],a.async=1,a.src=c,a.charset="utf-8",n.parentNode.insertBefore(a,n)}(window,document,0,("https:"==document.location.protocol?"https:":"http:")+"//widget.daovoice.io/widget/0f81ff2f.js","daovoice"),daovoice("init",{app_id:"e28768be"}),daovoice("update")</script><title>强力Django+杀手级Xadmin打造在线教育平台(三) | mtianyan's blog</title><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?415372bd35fec36f7558dd96b48ec03f";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div> <a href="https://github.com/mtianyan" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">mtianyan's blog</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">天涯明月笙的博客小站(Github托管)</p></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="menu-item-icon fa fa-fw fa-heartbeat"></i><br> 公益404</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br> 搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://blog.mtianyan.cn/post/ac975bcd.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="mtianyan"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="mtianyan's blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">强力Django+杀手级Xadmin打造在线教育平台(三)</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-08T22:09:17+08:00">2018-01-08</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Django-Xadmin打造在线教育平台/" itemprop="url" rel="index"><span itemprop="name">Django+Xadmin打造在线教育平台</span></a></span></span> <span id="/post/ac975bcd.html" class="leancloud_visitors" data-flag-title="强力Django+杀手级Xadmin打造在线教育平台(三)"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">热度&#58;</span><span class="leancloud-visitors-count"></span> <span>℃</span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">6,596</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">27</span></div></div></header><div class="post-body" itemprop="articleBody"><blockquote class="blockquote-center"><p>小项目不扫何以扫天下</p></blockquote><div class="note success"><p>使用Django+Xadmin打造在线教育平台</p><ul><li>第三章：通过留言板功能回顾django基础知识<br>通过做一个小留言板，学习django基础知识<br>教程仓库地址1: <a href="https://github.com/mtianyan/DjangoGetStarted" target="_blank" rel="noopener">https://github.com/mtianyan/DjangoGetStarted</a></li></ul></div><a id="more"></a><p>教程中本章对应上传的仓库为: <a href="https://github.com/mtianyan/DjangoGetStarted" target="_blank" rel="noopener">https://github.com/mtianyan/DjangoGetStarted</a></p><blockquote><p>对应第一次commit:留言板仓库初始化。内容截止3-1一章结束。</p></blockquote><ul><li>将对于django目录结构，使用Django快速搭建可以提交的表单页面，models.py , urls.py, views.py。</li><li>从数据库中取出数据展示到html中：Django Template的配置。</li><li>即django的基础知识通过这个留言板项目进行一个全面细致的学习。</li></ul><h2 id="3-1-django目录结构"><a href="#3-1-django目录结构" class="headerlink" title="3-1 django目录结构"></a>3-1 django目录结构</h2><p>django目录：</p><pre><code>projectname : 保存Django项目的urls,setting，uwsgi文件
</code></pre><p>如下图新建一个Django项目<code>DjangoGetStarted</code>，使用我们上章节中已存在的虚拟环境<code>DjangoTest</code> (里面已经装好了django)</p><p><img src="http://myphoto.mtianyan.cn/blog/180106/BKLg4JDJCe.png?imageslim" alt="mark"></p><h3 id="django自动生成的目录"><a href="#django自动生成的目录" class="headerlink" title="django自动生成的目录"></a>django自动生成的目录</h3><p>初始化完成后的目录如下：(如果不是，那么你们可能创建的不是django项目)</p><p><img src="http://myphoto.mtianyan.cn/blog/180106/3aIIDddEmc.png?imageslim" alt="mark"></p><p>可以看到主目录<code>DjangoGetStarted</code>与项目目录<code>DjangoGetStarted</code></p><ul><li>DjangoGetStarted(文件夹)：<ul><li>setting.py： 项目全局配置文件</li><li>urls.py： 主要的urls配置入口</li><li>wsgi.py： 是Django启动需要的文件。</li></ul></li><li>templates(文件夹)： 放置html文件</li><li>manage.py： 启动Django需要的主要文件。(主要的Django命令都通过manage.py运行)</li></ul><h3 id="还需要我们自己创建的目录"><a href="#还需要我们自己创建的目录" class="headerlink" title="还需要我们自己创建的目录"></a>还需要我们自己创建的目录</h3><p>app是Django里一个一个应用的文件夹单位。</p><p>通过 <code>Tools -&gt; Run manage.py Task</code>创建app：</p><p><img src="http://myphoto.mtianyan.cn/blog/180106/lFgLChlhdc.png?imageslim" alt="mark"></p><h4 id="startapp-message"><a href="#startapp-message" class="headerlink" title="startapp message"></a>startapp message</h4><p>可以看到当输入<code>startapp message</code>之后，创建了<code>message</code>应用。并存放在了：与项目目录同级目录。</p><p><img src="http://myphoto.mtianyan.cn/blog/180106/Ef2F5Bf7FA.png?imageslim" alt="mark"></p><h4 id="新建static目录"><a href="#新建static目录" class="headerlink" title="新建static目录"></a>新建static目录</h4><p>使用<code>static</code>目录来存放网站的静态文件：js，css，图片等。</p><h4 id="新建log目录"><a href="#新建log目录" class="headerlink" title="新建log目录"></a>新建log目录</h4><p>使用<code>log</code>目录来存放网站的日志文件</p><h4 id="新建media目录"><a href="#新建media目录" class="headerlink" title="新建media目录"></a>新建media目录</h4><p>使用<code>media</code>目录存放用户上传的图片等资源。</p><h4 id="解决项目大了之后app过多问题"><a href="#解决项目大了之后app过多问题" class="headerlink" title="解决项目大了之后app过多问题"></a>解决项目大了之后app过多问题</h4><ol><li>新建文件夹 <code>apps</code></li><li>将<code>message</code>文件夹拖入<code>apps</code>文件夹内：会自动生成<code>__init__.py</code>文件表明这是一个包。使得apps文件夹可导入。</li></ol><p><img src="http://myphoto.mtianyan.cn/blog/180106/3625a0imed.png?imageslim" alt="mark"></p><blockquote><p>这时我们就会发现在导入我们的message的内容就得配置较长的路径。</p></blockquote><p><img src="http://myphoto.mtianyan.cn/blog/180107/k10eEBg357.png?imageslim" alt="mark"></p><blockquote><p>每次前面都得加上<code>apps.</code>，这可烦死人啦。</p></blockquote><p><strong>解决方案奉上</strong></p><blockquote><p>将<code>apps</code>目录右键<code>mark</code>成<code>Source Root</code>(Mark 方法查看第一章pycharm简单使用：目录颜色不同的原因)</p></blockquote><p><img src="http://myphoto.mtianyan.cn/blog/180107/I9255edkaF.png?imageslim" alt="mark"></p><p>mark成功之后<strong>变蓝</strong>(变绿的话，只能摸摸头了，当然选择原谅)，然后可以直接使用短路径进行import</p><h4 id="Mark后Pycharm-不报错，Cmd下运行报错。"><a href="#Mark后Pycharm-不报错，Cmd下运行报错。" class="headerlink" title="Mark后Pycharm 不报错，Cmd下运行报错。"></a>Mark后Pycharm 不报错，Cmd下运行报错。</h4><p>Mark后pycharm知道这是一个项目的<code>Souce Root</code>路径了，但是cmd并不知道。</p><blockquote><p>在项目目录下通过cmd命令行使用<code>python manage.py runserver</code></p></blockquote><p><img src="http://myphoto.mtianyan.cn/blog/180107/2043A3KagE.png?imageslim" alt="mark"></p><blockquote><p>pycharm中mark只是pycharm自身可以进行识别短路径。</p></blockquote><p><strong>解决方案：</strong></p><blockquote><p>我们在setting文件中配置我们的<code>apps</code>路径:</p></blockquote><p><img src="http://myphoto.mtianyan.cn/blog/180107/IhD2bJDI6K.png?imageslim" alt="mark"></p><blockquote><p>图解读：我们需要在setting中向上图一样设置,程序就会接着报错。(换了一个错误了，滑稽脸)</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.path.insert(<span class="number">0</span>,os.path.join(BASE_DIR,<span class="string">'apps'</span>))</span><br></pre></td></tr></table></figure><p>上述代码为将apps拼接项目绝对路径后的路径插入当前系统的环境变量path中，这样就可以成功解决(个屁屁啊)。</p><p>成功性测试(测试已失败)：</p><blockquote><p>这个import放到manage.py文件是不行的 你把manage.py中这行删除 因为django整个的配置还没有启动好 import django的model是不行的，</p></blockquote><p>插播：忘了失败吧，我偷学下面方法养你。</p><p><strong>终极解决：将这个<code>import</code>方法比如urls.py.等可以成功启动。</strong>或者自行删除该import。</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/b230j2d65e.png?imageslim" alt="mark"></p><p>红色警告：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">You have unapplied migrations; your app may not work properly </span><br><span class="line">until they are applied. Run &apos;python manage.py migrate&apos; to apply them.</span><br></pre></td></tr></table></figure><p></p><p>是因为我们没有进行数据库<code>models</code>进行初始化<code>migrate</code>.</p><p><code>python manage.py migrate</code>我们之后会用到，现在不要做。</p><h3 id="github仓库项目初始化第一次commit。"><a href="#github仓库项目初始化第一次commit。" class="headerlink" title="github仓库项目初始化第一次commit。"></a>github仓库项目初始化第一次commit。</h3><p><img src="http://myphoto.mtianyan.cn/blog/180107/aFheliD18B.png?imageslim" alt="mark"></p><blockquote><p>输入用户名密码，点击login。</p></blockquote><p><img src="http://myphoto.mtianyan.cn/blog/180107/ci4AKb7Lb0.png?imageslim" alt="mark"></p><blockquote><p>选择左侧导航中<code>Git</code> 设置你的git.exe的路径</p></blockquote><p><img src="http://myphoto.mtianyan.cn/blog/180107/6Af7m9cI0i.png?imageslim" alt="mark"></p><p>点击<code>Share project on GitHub</code>会弹出下图窗口</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/JjH1FjmB0i.png?imageslim" alt="mark"></p><p>填写你的项目<code>名称</code>，<code>描述</code>。点击<code>share</code>。</p><p>会弹窗让你选择需要上传的项目文件与commit信息。然后将项目上传至github。</p><p><strong>我教程中上传的仓库为: <a href="https://github.com/mtianyan/DjangoGetStarted" target="_blank" rel="noopener">https://github.com/mtianyan/DjangoGetStarted</a></strong></p><blockquote><p>对应第一次commit:留言板仓库初始化。内容截止3-1一章结束。</p></blockquote><h2 id="3-2-配置表单页面"><a href="#3-2-配置表单页面" class="headerlink" title="3-2 配置表单页面"></a>3-2 配置表单页面</h2><blockquote><p>上节教程(来学习本节前置条件):</p></blockquote><ul><li>对应第一次commit: 留言板仓库初始化。内容截止3-1一章结束。</li></ul><p><strong>github仓库地址：<a href="https://github.com/mtianyan/DjangoGetStarted" target="_blank" rel="noopener">https://github.com/mtianyan/DjangoGetStarted</a></strong></p><blockquote><p>本节我们学习将表单页面配置进django项目中</p></blockquote><h3 id="必要的该说的，该了解的"><a href="#必要的该说的，该了解的" class="headerlink" title="必要的该说的，该了解的"></a>必要的该说的，该了解的</h3><p><strong>前置条件：</strong></p><blockquote><p>你已经学习了前面教程。将项目的文件夹目录结构，setting配置等修改完毕与我保持一致。</p></blockquote><p>本节通过Django快速的配置一个<strong>留言板页面</strong>来学习</p><p>Django从请求到响应的整个完整流程。为我们开发在线教育平台打下基础。</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/ghebBaKDDa.png?imageslim" alt="mark"></p><p>上图便是本节教程所要用到的静态页面: 前往Github下载：<code>form.html</code></p><blockquote><p>具体的业务：填写信息 -&gt; 然后点击提交 -&gt;数据被存储到数据库。</p></blockquote><p>这个<code>html</code>是一个单文件，里面已经包含了<code>css</code> <code>js</code>内容。</p><h3 id="将html文件整合进项目操作步骤"><a href="#将html文件整合进项目操作步骤" class="headerlink" title="将html文件整合进项目操作步骤"></a>将html文件整合进项目操作步骤</h3><h4 id="将html文件直接复制进templates目录"><a href="#将html文件直接复制进templates目录" class="headerlink" title="将html文件直接复制进templates目录."></a>将<code>html</code>文件直接复制进<code>templates</code>目录.</h4><p><img src="http://myphoto.mtianyan.cn/blog/180107/bd7L9HEbB1.png?imageslim" alt="mark"></p><h4 id="创建static目录下的css文件夹-和-static-js"><a href="#创建static目录下的css文件夹-和-static-js" class="headerlink" title="创建static目录下的css文件夹 和 static/js"></a>创建<code>static目录下的css文件夹</code> 和 <code>static/js</code></h4><ul><li>在css中再新建一个<code>style.css</code></li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180107/7L3m4291JK.png?imageslim" alt="mark"></p><ul><li><code>form.html</code>中点击<code>&lt;style&gt;</code>标签左侧减号。将style内容收成一行。然后把这一行内容<strong>剪切粘贴到</strong><code>style.css</code></li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180107/EJHc2DdkK2.png?imageslim" alt="mark"></p><ul><li><p>粘贴进去之后，<strong>将首尾两个<code>&lt;style&gt;</code>删除</strong>,<code>shift + tab</code>可以将css格式化更整齐。</p></li><li><p>在<code>form.html</code>新建<code>&lt;link&gt;</code>来引入css。(文件里其实已经先加上了，学一种操作而已)</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"/static/css/style.css"</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="配置Django连接Mysql数据库"><a href="#配置Django连接Mysql数据库" class="headerlink" title="配置Django连接Mysql数据库"></a>配置Django连接Mysql数据库</h3><p>在<code>setting.py</code> 大概80行找到:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    &apos;default&apos;: &#123;</span><br><span class="line">        &apos;ENGINE&apos;: &apos;django.db.backends.sqlite3&apos;,</span><br><span class="line">        &apos;NAME&apos;: os.path.join(BASE_DIR, &apos;db.sqlite3&apos;),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这是Django默认与自己项目根目录下的<code>db.sqlite3</code>连接的设置。</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/00e3abbbFJ.png?imageslim" alt="mark"></p><p>我们的项目是与<code>mysql</code>连接，所以我们要改成如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    &apos;default&apos;: &#123;</span><br><span class="line">        &apos;ENGINE&apos;: &apos;django.db.backends.mysql&apos;,</span><br><span class="line">        &apos;NAME&apos;: &apos;testdjango&apos;,</span><br><span class="line">        &apos;USER&apos;: &apos;root&apos;,</span><br><span class="line">        &apos;PASSWORD&apos;: &apos;密码&apos;,</span><br><span class="line">        &apos;HOST&apos;: &quot;127.0.0.1&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中的<code>name</code>应设置为我们中在Navicat中新建的数据库名字。<strong>名字一定要保持一致</strong></p><p>这时要将我们之前建的表提前<strong>全部删除</strong>掉。</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/g8l89KCfam.png?imageslim" alt="mark"></p><h4 id="配置mysql驱动和seeting文件。"><a href="#配置mysql驱动和seeting文件。" class="headerlink" title="配置mysql驱动和seeting文件。"></a>配置mysql驱动和seeting文件。</h4><p>点击<code>Tools 菜单下 Run manage.py Task</code>我们会发现报错了：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">    raise ImproperlyConfigured(&quot;Error loading MySQLdb module: %s&quot; % e)</span><br><span class="line">django.core.exceptions.ImproperlyConfigured: Error loading MySQLdb module: No module named MySQLdb</span><br></pre></td></tr></table></figure><blockquote><p>由错误信息我们可以看出是因为没有安装数据库驱动模块<code>MySQLdb</code></p></blockquote><p><img src="http://myphoto.mtianyan.cn/blog/180107/lJKDjik9Cb.png?imageslim" alt="mark"></p><p><code>cmd</code>下<code>workon</code>进我们的虚拟环境目录。<code>pip install mysql-python</code><br>然后会发现报错：</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/65Gad4D4l9.png?imageslim" alt="mark"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">_mysql.c(42) : fatal error C1083: Cannot open include file: &apos;config-win.h&apos;: </span><br><span class="line">No such file or directory error: command </span><br><span class="line">&apos;&quot;C:\Users\mtian\AppData\Local\Programs\Common\Microsoft\Visual C ++ </span><br><span class="line">for Python\9.0\VC\Bin\amd64\cl.exe&quot;&apos; failed with exit status 2</span><br></pre></td></tr></table></figure><p>前往地址 <a href="https://www.lfd.uci.edu/~gohlke/pythonlibs/#mysql-python" target="_blank" rel="noopener">https://www.lfd.uci.edu/~gohlke/pythonlibs/#mysql-python</a></p><p>下载<code>MySQL_python_1.2.5_cp27_none_win_amd64.whl</code>到本地,放到桌面。<br>然后使用下面命令进行安装：注意是在虚拟环境下。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd Desktop</span><br><span class="line">pip install MySQL_python-1.2.5-cp27-none-win_amd64.whl</span><br></pre></td></tr></table></figure><p><img src="http://myphoto.mtianyan.cn/blog/180107/G60aadGLkJ.png?imageslim" alt="mark"></p><p>这个时候我们再次点击<code>Tools 菜单下 Run manage.py Task</code>会看到已经没有刚才的错误。<br><img src="http://myphoto.mtianyan.cn/blog/180107/4mF5KmaCKj.png?imageslim" alt="mark"><br>但是会有红框里的警告，<strong>面向强迫症解决方案是</strong>在<code>setting.py</code> 新增<code>STATIC_ROOT = &#39;/static/&#39;</code></p><p>但其实现在还没有用到这个参数。后面用到我们再配置。(推荐自行克服强迫症)</p><p>输入下面命令来生成表:<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">makemigrations</span><br><span class="line">migrate</span><br></pre></td></tr></table></figure><p></p><p><img src="http://myphoto.mtianyan.cn/blog/180107/gaaL4hlAGj.png?imageslim" alt="mark"></p><p>这时我们去Navicat查看会发现为我们生成了很多表。</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/bK273a3j4D.png?imageslim" alt="mark"></p><p>这些都是Django系统默认的<strong>内置</strong>数据表。</p><p>做完这些操作我们可以点击<code>Run</code>来运行项目，<br>然后到<code>http://127.0.0.1:8000/</code>来访问看是否运行成功。成功页面(It worked)</p><h3 id="配置form页面展示出来："><a href="#配置form页面展示出来：" class="headerlink" title="配置form页面展示出来："></a>配置form页面展示出来：</h3><p><code>DjangoGetStarted/urls.py</code>修改如下:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">urlpatterns = [</span><br><span class="line">    url(<span class="string">r'^admin/'</span>, admin.site.urls),</span><br><span class="line">    url(<span class="string">r'^form/$'</span>, getform) <span class="comment">#这行是新增加的.</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>新增加<code>url(r&#39;^form/$&#39;, getform)</code>,<code>^</code>是代表以<code>form</code>为开头，<code>$</code>代表以<code>/</code>结尾的地址。<br>这里<code>getform</code> 是对于这个<code>url</code>的相应处理的<code>view</code>。我们先去创建一个.</p><p><code>message/views.py</code>添加如下代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getform</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">'message_form.html'</span>)</span><br></pre></td></tr></table></figure><p><code>request</code> 参数是一个django的<code>http request</code>对象。(基础)<br>这里我们可以按住<code>ctrl</code> + <code>左键</code> 跟踪到我们的<code>render</code>函数里面。<br><code>Alt + 左箭头</code> 回来。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">render</span><span class="params">(request, template_name,...)</span>:</span></span><br></pre></td></tr></table></figure><p>源代码解读：可以看到我们的<code>render</code>需要一个<code>request对象</code>和<code>template_name</code>参数</p><p><strong>注意：记性好的还记得我们提供的源文件是form.html</strong></p><blockquote><p>知识点：django内置了很多html页面，form会先从内置中寻找。所以我们得改。</p></blockquote><p>因此我们需要右键如下图<code>Refactor</code>修改<code>from.html</code> 为<code>message_form</code></p><p><img src="http://myphoto.mtianyan.cn/blog/180107/l0I7CGB2Be.png?imageslim" alt="mark"></p><p>如果我们的项目在运行，<code>ctrl + s</code>会自动重启我们的项目。</p><p>这时我们有了view，我们可以去配置完整的url了(前面已经配完整的检查一遍)：</p><p><code>DjangoGetStarted/urls.py</code><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from message.views import getform</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(r&apos;^admin/&apos;, admin.site.urls),</span><br><span class="line">    url(r&apos;^form/$&apos;, getform)</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p></p><p><strong>这里我们不能加括号</strong>否则会变成方法的调用。</p><p>按住<code>ctrl</code> + <code>render</code> 跟踪到我们的<code>url</code>函数里面查看源码如下:可以看到它除过一组正则表达式，还需要接收一个view对象。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">def url(regex, view,...):</span><br></pre></td></tr></table></figure><p>如果<code>getform</code>加上括号会报错：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TypeError: getform() takes exactly 1 argument (0 given)</span><br></pre></td></tr></table></figure><p>访问<code>http://127.0.0.1:8000/</code> 正常结果：Page not found</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Using the URLconf defined in DjangoGetStarted.urls, Django tried these URL patterns, in this order:</span><br><span class="line"></span><br><span class="line">^admin/</span><br><span class="line">^form/$</span><br></pre></td></tr></table></figure><p>是因为我们在url中加入了个人的配置<code>^form/$</code>,它就不会采用默认配置了。</p><p>原因：(源码探究标记点)</p><p>这时访问：<a href="http://127.0.0.1:8000/form/" target="_blank" rel="noopener">http://127.0.0.1:8000/form/</a></p><p>旧版本pycharm会报：<code>TemplateDoesNotExist</code>错误。我的新版本pycharm并没有出现。</p><p>重要代码在<code>DjangoGetStarted/settings.py</code> 60行左右</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 指明我们的templates目录路径</span><br><span class="line">&apos;DIRS&apos;: [os.path.join(BASE_DIR, &apos;templates&apos;)]</span><br><span class="line"># 老版本pycharm创建django项目该值为空。</span><br></pre></td></tr></table></figure><p>现在再次访问 <a href="http://127.0.0.1:8000/form/" target="_blank" rel="noopener">http://127.0.0.1:8000/form/</a></p><p><strong>页面出来了但是样式没有。static目录下的css文件提示没有找到。</strong></p><p><img src="http://myphoto.mtianyan.cn/blog/180107/73EjmflBe9.png?imageslim" alt="mark"></p><p>Setting中静态文件的配置，这是因为我们setting中的</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">STATIC_URL = &apos;/static/&apos;</span><br></pre></td></tr></table></figure><p>只说明了目录的名称。并没有指明查找的根路径。添加下面代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">STATIC_URL = &apos;/static/&apos;</span><br><span class="line">STATICFILES_DIRS = [</span><br><span class="line">    os.path.join(BASE_DIR, &apos;static&apos;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p><strong>过程中看似不停的出错</strong>，其实是为了让大家更好记住该记住的。</p><h3 id="项目配置流程图"><a href="#项目配置流程图" class="headerlink" title="项目配置流程图"></a>项目配置流程图</h3><p>我们刚才是以倒序：</p><ol><li>把html文件放进来</li><li>通过简单的url配置来访问html。</li><li>发现找不到页面，所以我们设置setting中<code>DIRS</code></li><li>文件找到了又说找不到静态文件，我们设置了<code>STATICFILES_DIRS</code></li></ol><p><img src="http://myphoto.mtianyan.cn/blog/180107/ihf44icl9d.png?imageslim" alt="mark"></p><p>这是我们的整体流程图，推荐新建一个项目再按照正向流程图来一遍。</p><p>后面我们的工作会围绕从<code>migration生成数据表往下的内容</code>展开。</p><p>GitHub地址：<a href="https://github.com/mtianyan/DjangoGetStarted" target="_blank" rel="noopener">https://github.com/mtianyan/DjangoGetStarted</a></p><blockquote><p>本节结束对应于commit：</p></blockquote><h2 id="3-3-django-orm介绍与model设计"><a href="#3-3-django-orm介绍与model设计" class="headerlink" title="3-3 django orm介绍与model设计"></a>3-3 django orm介绍与model设计</h2><p>上节教程完成后代码(来学习本节前置条件):</p><p><strong>github仓库地址：<a href="https://github.com/mtianyan/DjangoGetStarted" target="_blank" rel="noopener">https://github.com/mtianyan/DjangoGetStarted</a></strong></p><ul><li>对应commit: 留言板前端页面展示。本次内容截止教程3-2结束。</li></ul><blockquote><p>可能现在你还在通过手写sql语句来操作数据库，当我们有了orm，数据库操作变得很简单。这一小节我们来学习Django中的orm。</p></blockquote><h3 id="原生sql-与-orm"><a href="#原生sql-与-orm" class="headerlink" title="原生sql 与 orm"></a>原生sql 与 orm</h3><p>没有orm 的情况下message/views.py代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import MySQLdb</span><br><span class="line"></span><br><span class="line"># 使用原生sql获取书的列表</span><br><span class="line">def book_list(request):</span><br><span class="line">    # 创建到数据库的连接: 指明用户名，数据库，密码</span><br><span class="line">    db = MySQLdb.connect(user = &apos;me&apos;, db=&apos;mydb&apos;, passwd=&apos;secret&apos;, host=&apos;localhost&apos;)</span><br><span class="line">    # 创建一个游标对象执行器</span><br><span class="line">    cursor = db.cursor()</span><br><span class="line">    # 书写我们需要的sql语句</span><br><span class="line">    cursor.execute(&apos;SELECT name FROM books ORDER BY name&apos;)</span><br><span class="line">    # 对于fetchall()的结果做遍历，将遍历回来的结果当做数组，取第0个值name。</span><br><span class="line">    names = [row[0] for row in cursor.fetchall()]</span><br><span class="line">    db.close()</span><br></pre></td></tr></table></figure><p>可不可以让数据库字段的查询和使用类的一个属性一样简单？没错登登登：orm上场了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">book:name</span><br><span class="line"></span><br><span class="line">book.name</span><br><span class="line">book.save()</span><br></pre></td></tr></table></figure><p>Django的orm就是为了让我们不再写上面那样的语句，而是像使操作数据库像使用类和类属性一样。</p><h3 id="创建我们的models"><a href="#创建我们的models" class="headerlink" title="创建我们的models"></a>创建我们的models</h3><blockquote><p>verbose_name:对象的人类可读的名称，单数:<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">verbose_name = <span class="string">"pizza"</span></span><br></pre></td></tr></table></figure><p></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">class Meta，内嵌于 UserMessage 这个类的定义中</span><br><span class="line">如果 class Publisher 是顶格的，那么 class Meta 在它之下要缩进4个空格－－按 Python 的传统</span><br><span class="line">你可以在任意一个 模型 类中使用 Meta 类，来设置一些与特定模型相关的选项。</span><br><span class="line">如：设置ordering = [&apos;name&apos;]，默认地都会按 name 字段排序</span><br></pre></td></tr></table></figure><p>message/models.py：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 继承于django.db.models.Model</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserMessage</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    <span class="comment"># 设置最大长度，verbose_name在后台显示字段会用到</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">20</span>, verbose_name=<span class="string">u"用户名"</span>)</span><br><span class="line">    <span class="comment"># Django提供内置的邮箱字段会帮忙验证` default_validators = [validators.validate_email]`</span></span><br><span class="line">    email = models.EmailField(verbose_name=<span class="string">u"邮箱"</span>)</span><br><span class="line">    address = models.CharField(max_length=<span class="number">100</span>, verbose_name=<span class="string">u"联系地址"</span>)</span><br><span class="line">    message = models.CharField(max_length=<span class="number">500</span>, verbose_name=<span class="string">u"留言信息"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        verbose_name = <span class="string">u"用户留言信息"</span></span><br><span class="line">        <span class="comment"># db_table ，这里我们让它自动生成所以不用指定</span></span><br></pre></td></tr></table></figure><p>这时我们执行<code>makemigrations messages</code>会发现并没有改动。</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/bCK3e2eF9C.png?imageslim" alt="mark"></p><blockquote><p>因为setting中我们没有注册我们的app: message</p></blockquote><p><strong>注意：新建的app都要在setting中注册</strong></p><h3 id="在setting中注册我们的app"><a href="#在setting中注册我们的app" class="headerlink" title="在setting中注册我们的app"></a>在setting中注册我们的app</h3><p>DjangoGetStarted/settings.py 大概36行<code>INSTALLED_APPS</code>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">`INSTALLED_APPS`</span><br><span class="line">[</span><br><span class="line">    前面的不用变，后面新增下一行</span><br><span class="line">    &apos;message&apos;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>这时候我们重新运行<code>Tools 菜单下 Run manage.py Task</code>会提示：</p><p>如果提示：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SyntaxError: Non-ASCII character &apos;\xe7&apos; in file D:\CodeSpace\PythonProject\DjangoGetStarted\apps\message\models.py on line</span><br></pre></td></tr></table></figure><p></p><p>请注意可能你忘记在写过中文的地方加上:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#coding: utf-8</span><br></pre></td></tr></table></figure><p><strong>注意必须加在第一或二行。</strong></p><p>然后执行下面命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">makemigrations message</span><br></pre></td></tr></table></figure><p><img src="http://myphoto.mtianyan.cn/blog/180107/7j9GC32b44.png?imageslim" alt="mark"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">migrate message 生成数据表</span><br></pre></td></tr></table></figure><p><img src="http://myphoto.mtianyan.cn/blog/180107/dbKECKEBFg.png?imageslim" alt="mark"></p><p>前往Navicat验证：</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/26GK5BjhCd.png?imageslim" alt="mark"></p><blockquote><p>可以看到我们的数据表已经创建成功。默认数据表名称为<code>app名称_类名转换为小写</code><br>自动生成的id作为主键。</p></blockquote><h3 id="Models讲解"><a href="#Models讲解" class="headerlink" title="Models讲解"></a>Models讲解</h3><p>除过普通的对应数据库的字段类型如<code>CharField</code>，还有很多高级类型。如<code>EmailField</code>提供email验证。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">models.ForeignKey     # 外键</span><br><span class="line">models.DateTimeField  # 时间字段</span><br><span class="line">models.IntegerField   # 整型</span><br><span class="line">models.IPAddressField # IP地址</span><br><span class="line">models.FileField      # 上传文件</span><br><span class="line">models.ImageField     # 图片</span><br></pre></td></tr></table></figure><blockquote><p>ctrl按住+左键点击<code>models</code> 进入之后点击<code>fields</code>拖到文件开始可以看到所有字段：</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">__all__ = [str(x) for x in (</span><br><span class="line">    &apos;AutoField&apos;, &apos;BLANK_CHOICE_DASH&apos;, &apos;BigIntegerField&apos;, &apos;BinaryField&apos;,</span><br><span class="line">    &apos;BooleanField&apos;, &apos;CharField&apos;, &apos;CommaSeparatedIntegerField&apos;, &apos;DateField&apos;,</span><br><span class="line">    &apos;DateTimeField&apos;, &apos;DecimalField&apos;, &apos;DurationField&apos;, &apos;EmailField&apos;, &apos;Empty&apos;,</span><br><span class="line">    &apos;Field&apos;, &apos;FieldDoesNotExist&apos;, &apos;FilePathField&apos;, &apos;FloatField&apos;,</span><br><span class="line">    &apos;GenericIPAddressField&apos;, &apos;IPAddressField&apos;, &apos;IntegerField&apos;, &apos;NOT_PROVIDED&apos;,</span><br><span class="line">    &apos;NullBooleanField&apos;, &apos;PositiveIntegerField&apos;, &apos;PositiveSmallIntegerField&apos;,</span><br><span class="line">    &apos;SlugField&apos;, &apos;SmallIntegerField&apos;, &apos;TextField&apos;, &apos;TimeField&apos;, &apos;URLField&apos;,</span><br><span class="line">    &apos;UUIDField&apos;,</span><br><span class="line">)]</span><br></pre></td></tr></table></figure><h4 id="介绍字段参数"><a href="#介绍字段参数" class="headerlink" title="介绍字段参数"></a>介绍字段参数</h4><p><code>CharField</code>必须指明默认最大长度。<code>null=True,blank=True</code>指明字段可以为空<br><code>defalut = &quot; &quot;</code>指定默认值。<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name = models.CharField(max_length=20,null=True,blank=True, verbose_name=u&quot;用户名&quot;)</span><br></pre></td></tr></table></figure><p></p><p>id是自动生成的，如果需要自定义主键,message/models.py中添加字段：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">object_id = models.CharField(primary_key=True, verbose_name=&quot;主键&quot;)</span><br></pre></td></tr></table></figure><p>此时点击<code>Tools 菜单下 Run manage.py Task</code>输入<code>makemigrations message</code></p><p><img src="http://myphoto.mtianyan.cn/blog/180107/IA82jEgmAG.png?imageslim" alt="mark"></p><p><strong>知识点：CharField必须指明最大长度</strong></p><p>object_id改为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">object_id = models.CharField(primary_key=True, max_length=50 ,verbose_name=&quot;主键&quot;)</span><br></pre></td></tr></table></figure><p>这时点击<code>Tools 菜单下 Run manage.py Task</code>输入<code>makemigrations message</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">You are trying to add a non-nullable field <span class="string">'object_id'</span> to usermessage without a default; we can<span class="string">'t do that (the database needs something to populate existing rows).</span></span><br><span class="line"><span class="string">Please select a fix:</span></span><br><span class="line"><span class="string"> 1) Provide a one-off default now (will be set on all existing rows)</span></span><br><span class="line"><span class="string"> 2) Quit, and let me add a default in models.py</span></span><br></pre></td></tr></table></figure><p>根据提示信息，我们需要给<code>object_id</code>添加默认值：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">object_id = models.CharField(primary_key=True, max_length=50,default=&quot;&quot;, verbose_name=&quot;主键&quot;)</span><br></pre></td></tr></table></figure><p><strong>get新知识点：object_id必须有默认值</strong></p><p>输入<code>2</code> 退出：然后输入<code>makemigrations message</code></p><p><img src="http://myphoto.mtianyan.cn/blog/180107/0HhH9l2B9G.png?imageslim" alt="mark"></p><p>再输入下面命令生成数据表<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">migrate message</span><br></pre></td></tr></table></figure><p></p><blockquote><p>可以看到上图过程中会告诉我们做了哪些变化，如删除了默认系统生成的主键<code>id</code><br>,变更了<code>name</code>。新增了我们的<code>object_id</code></p></blockquote><p>前往Navicat验证右键设计表：</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/0hADe4ggDG.png?imageslim" alt="mark"></p><p>可以看到<code>object_id</code>已经成为我们的新主键。</p><h4 id="介绍Meta信息："><a href="#介绍Meta信息：" class="headerlink" title="介绍Meta信息："></a>介绍Meta信息：</h4><p>Meta信息中我们可以指定常见的类型：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db_table = &quot;user_meassage&quot;</span><br></pre></td></tr></table></figure><p>自定义后生成表，表名会与我们的保持一致。而不会前缀<code>appname</code>如：<code>message_</code></p><blockquote><p>这里因为我们已经生成过了，就不要做验证改变表名了。</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ordering = &apos;-object_id&apos;</span><br></pre></td></tr></table></figure><p>ordering指定默认排序字段,如：就会以object_id倒序</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">verbose_name_plural = u&quot;用户留言信息&quot;</span><br></pre></td></tr></table></figure><p>verbose_name_plural：复数信息，便于人阅读。否则会在后台显示<code>用户留言信息s</code></p><p>已经学习完毕了<code>orm</code>将数据表映射表。<br>github地址：<a href="https://github.com/mtianyan/DjangoGetStarted" target="_blank" rel="noopener">https://github.com/mtianyan/DjangoGetStarted</a><br>此节结束对应github commit:</p><blockquote><p>留言板数据库orm映射成表完成。内容截止教程3-3结束。</p></blockquote><h2 id="3-4-django-model的增删改"><a href="#3-4-django-model的增删改" class="headerlink" title="3-4 django model的增删改"></a>3-4 django model的增删改</h2><p><strong>github仓库地址：<a href="https://github.com/mtianyan/DjangoGetStarted" target="_blank" rel="noopener">https://github.com/mtianyan/DjangoGetStarted</a></strong></p><ul><li>上小节完成代码对应commit: 留言板数据库orm映射成表完成。内容截止教程3-3结束。</li></ul><p>在<code>message/views.py</code>中:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> UserMessage</span><br></pre></td></tr></table></figure><p>将我们刚才创建的model，import进来。<code>.</code>代表是与当前同级的目录。</p><p>按照下图所示添加一条测试数据。</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/IBga4E2FGh.png?imageslim" alt="mark"></p><p>然后再我们的<code>getform</code>方法内部添加下面代码：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def getform(request):</span><br><span class="line">    # UserMessage默认的数据管理器objects。</span><br><span class="line">    # 方法all()是将所有数据返回成一个queryset类型(django的内置类型)</span><br><span class="line">    all_message = UserMessage.objects.all()</span><br><span class="line"></span><br><span class="line">    #我们可以对于all_message进行遍历操作</span><br><span class="line">    for message in all_message:</span><br><span class="line">        # 每个message实际就是一个UserMessage对象（这时我们就可以使用对象的相关方法）。</span><br><span class="line">        print message.name</span><br><span class="line"></span><br><span class="line">    return render(request, &apos;message_form.html&apos;)</span><br></pre></td></tr></table></figure><p></p><p>调试过程：</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/FGChlB50k7.png?imageslim" alt="mark"></p><ul><li><p>点击上图小红框位置，打上断点。</p></li><li><p>点击Run -&gt; debug后：在浏览器里打开：<code>http://127.0.0.1:8000/form/</code></p></li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180107/mAebKF06m9.png?imageslim" alt="mark"></p><ul><li>弹出上图代表已进入断点。</li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180107/0cb6GGiGDa.png?imageslim" alt="mark"></p><ul><li><p>此时鼠标左键点击：all_message.可以看到这是一个<code>{QuerySet}类型的对象，里面存放着[&lt;UserMessage: UserMessage object&gt;]</code></p></li><li><p>按<code>f6</code>使运行到下一步。此时下方的值窗口内可以看到message的值。说明我们成功取到了数据库的值。</p></li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180107/hJgD3AC3c2.png?imageslim" alt="mark"></p><h3 id="filter取出指定要求值"><a href="#filter取出指定要求值" class="headerlink" title="filter取出指定要求值"></a>filter取出指定要求值</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">all_message = UserMessage.objects.filter(name=&apos; mtianyan&apos;, address=&apos;西安&apos;)</span><br></pre></td></tr></table></figure><p><img src="http://myphoto.mtianyan.cn/blog/180107/Eal2Ldj6e8.png?imageslim" alt="mark"></p><p>按照上面调试过程重新调试可以看到我们同样取出了值。</p><p>小练习：将名字改为与自己数据库存放值不同的。查看结果。</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/IChf8L7ecd.png?imageslim" alt="mark"></p><blockquote><p>变成了空列表，说明一切正确。</p></blockquote><h3 id="将数据存入数据库"><a href="#将数据存入数据库" class="headerlink" title="将数据存入数据库"></a>将数据存入数据库</h3><p>了解：django/db/models/base.py 源码中提供save方法<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save</span><span class="params">(self, force_insert=False, force_update=False, using=None,</span></span></span><br><span class="line"><span class="function"><span class="params">             update_fields=None)</span>:</span></span><br></pre></td></tr></table></figure><p></p><p>getform方法中添加代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 存储部分</span></span><br><span class="line"></span><br><span class="line">   <span class="comment"># 首先实例化一个对象</span></span><br><span class="line">   user_message = UserMessage()</span><br><span class="line"></span><br><span class="line">   <span class="comment"># 为对象增加属性</span></span><br><span class="line">   user_message.name = <span class="string">"mtianyan2"</span></span><br><span class="line">   user_message.message = <span class="string">"blog.mtianyan.cn"</span></span><br><span class="line">   user_message.address = <span class="string">"西安"</span></span><br><span class="line">   user_message.email = <span class="string">"1147727180@qq.com"</span></span><br><span class="line">   user_message.object_id = <span class="string">"efgh"</span></span><br><span class="line"></span><br><span class="line">   <span class="comment"># 调用save方法进行保存</span></span><br><span class="line">   user_message.save()</span><br></pre></td></tr></table></figure><ul><li>打上断点：如下图。</li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180107/3b7aeEg0KE.png?imageslim" alt="mark"></p><ul><li>一直惦记f6单步调试，直到如下图：蓝色到<code>return</code>语句</li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180107/m2fF7j38dC.png?imageslim" alt="mark"></p><p>可以在下方值窗口查看到值</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/bg6ICDcI9I.png?imageslim" alt="mark"></p><h3 id="Navicat进行验证"><a href="#Navicat进行验证" class="headerlink" title="Navicat进行验证"></a>Navicat进行验证</h3><blockquote><p>可以看到成功的添加了数据<code>mtianyan2</code></p></blockquote><p><img src="http://myphoto.mtianyan.cn/blog/180107/DiBKcaJd8A.png?imageslim" alt="mark"></p><h3 id="如何从html的提交中取到数据并保存进数据库"><a href="#如何从html的提交中取到数据并保存进数据库" class="headerlink" title="如何从html的提交中取到数据并保存进数据库"></a>如何从html的提交中取到数据并保存进数据库</h3><p>templates/message_form.html：</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/glha3bHaC8.png?imageslim" alt="mark"></p><blockquote><p>method是post。action就是指向我们在urls.py中配置的<code>/form/</code><br><strong>前面必须加斜杠指根路径下form</strong><br>里面的input会自动把值传递给后台：这时我们就可以在getform中取到刚才传递过来的值。</p></blockquote><p>运行项目：然后输入需要填写的值。点击提交：出现403错误</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Forbidden (403)</span><br><span class="line">CSRF verification failed. Request aborted.</span><br></pre></td></tr></table></figure><blockquote><p>根据提示：我们的页面没有进行crsf的验证，这时django的安全机制，不允许任意form都往后台提交。</p></blockquote><p><strong>知识点：所以我们需要在html页面中加入csrf_token</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% csrf_token %&#125;</span><br></pre></td></tr></table></figure><p><img src="http://myphoto.mtianyan.cn/blog/180107/chCamk6JDk.png?imageslim" alt="mark"></p><p>原有那行删除掉。打上断点</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/3cCBcF96eC.png?imageslim" alt="mark"></p><p>刷新页面并提交。这时候在值窗口可以看到request对象下的POST中存放着我们提交的数据。内容如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;QueryDict: &#123;u&apos;message&apos;: [u&apos;\u54c8\u54c8&apos;], u&apos;address&apos;: [</span><br><span class="line">u&apos;\u897f\u5b89\u5e02&apos;], u&apos;csrfmiddlewaretoken&apos;: [</span><br><span class="line">u&apos;uIYSMOTWPJBPOPucRwd3uDaWtCzeEaem&apos;], u&apos;name&apos;: [</span><br><span class="line">u&apos;\u5929\u6daf\u660e\u6708\u7b19&apos;], u&apos;email&apos;: [u&apos;1147727180@qq.com&apos;]&#125;&gt;</span><br></pre></td></tr></table></figure><p><img src="http://myphoto.mtianyan.cn/blog/180107/3BL02H2ljG.png?imageslim" alt="mark"></p><blockquote><p>数据以dict：key-value 形式存储 key是由如下图html中的name所决定对应的。</p></blockquote><p><img src="http://myphoto.mtianyan.cn/blog/180107/c2lIdeH2A1.png?imageslim" alt="mark"></p><h3 id="数据库新增。"><a href="#数据库新增。" class="headerlink" title="数据库新增。"></a>数据库新增。</h3><p><code>request.POST</code>中数据取出，存入<code>user_message</code>对象</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># html表单部分</span></span><br><span class="line"></span><br><span class="line">   <span class="comment"># 此处对应html中的method="post"，表示我们只处理post请求</span></span><br><span class="line">   <span class="keyword">if</span> request.method == <span class="string">"POST"</span>:</span><br><span class="line">       <span class="comment"># 就是取字典里key对应value值而已。取name，取不到默认空</span></span><br><span class="line">       name = request.POST.get(<span class="string">'name'</span>, <span class="string">''</span>)</span><br><span class="line">       message = request.POST.get(<span class="string">'message'</span>, <span class="string">''</span>)</span><br><span class="line">       address = request.POST.get(<span class="string">'address'</span>, <span class="string">''</span>)</span><br><span class="line">       email = request.POST.get(<span class="string">'email'</span>, <span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">       <span class="comment"># 实例化对象</span></span><br><span class="line">       user_message = UserMessage()</span><br><span class="line"></span><br><span class="line">       <span class="comment"># 将html的值传入我们实例化的对象.</span></span><br><span class="line">       user_message.name = name</span><br><span class="line">       user_message.message = message</span><br><span class="line">       user_message.address = address</span><br><span class="line">       user_message.email = email</span><br><span class="line">       user_message.object_id = <span class="string">"ijkl"</span></span><br><span class="line"></span><br><span class="line">       <span class="comment"># 调用save方法进行保存</span></span><br><span class="line">       user_message.save()</span><br></pre></td></tr></table></figure><ul><li>打断点在下图位置：</li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180107/gblC5dg219.png?imageslim" alt="mark"></p><ul><li>进入调试：点击点击method：是get请求。因为我们并没有按提交按钮，而是get这个网页</li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180107/heblbcAf4h.png?imageslim" alt="mark"></p><ul><li>点击f8继续运行我们的项目 浏览器中填写表单内容点提交。</li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180107/33ECK331eE.png?imageslim" alt="mark"></p><blockquote><p>因为这次是表单提交，已经变成了post方式。按<code>f6</code>进行单步调试。</p></blockquote><p>一直单步到如下图蓝色</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/4Ck700a9Ea.png?imageslim" alt="mark"></p><p>这时候值浏览窗口可以看到</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/i22jKb99Bh.png?imageslim" alt="mark"></p><blockquote><p>检查我们的user_message对象的属性是否已经全部添加进去，</p></blockquote><p>使用f8 继续项目并前往Navicat验证</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/0mJgFKbi9k.png?imageslim" alt="mark"></p><blockquote><p>可以看到我们的数据库中已经新增，标志着我们已经成功存入数据。</p></blockquote><h3 id="删除数据。"><a href="#删除数据。" class="headerlink" title="删除数据。"></a>删除数据。</h3><p>对于查询到的数据做删除：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法2 :filter取出指定条件值，逗号代表and 必须同时满足两个条件才返回。</span></span><br><span class="line">all_message = UserMessage.objects.filter(name=<span class="string">'mtianyan'</span>, address=<span class="string">'西安'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 我的数据库里保存着可以匹配到该条数据的一行。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除操作：使用delete方法删除all_message</span></span><br><span class="line"></span><br><span class="line">all_message.delete()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> message <span class="keyword">in</span> all_message:</span><br><span class="line">        <span class="comment"># 删除取到的message对象</span></span><br><span class="line">        message.detele()</span><br><span class="line">        <span class="comment"># print message.name</span></span><br></pre></td></tr></table></figure><p>点击run并访问：<a href="http://127.0.0.1:8000/form/" target="_blank" rel="noopener">http://127.0.0.1:8000/form/</a><br>进入Navicat进行验证。</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/BamdmLI1Ec.png?imageslim" alt="mark"></p><blockquote><p>可以看到我们的那条mtianyan + 西安的数据已经被删除。</p></blockquote><p><strong>至此：我们已经学会了新增，删除，查询。</strong></p><p>本节结束github对应commit：</p><blockquote><p>django model的增删改数据库。本次内容截止教程3-4。</p></blockquote><h2 id="3-5-django-url-templates配置"><a href="#3-5-django-url-templates配置" class="headerlink" title="3-5 django url templates配置"></a>3-5 django url templates配置</h2><blockquote><p>项目Github地址：<a href="https://github.com/mtianyan/DjangoGetStarted" target="_blank" rel="noopener">https://github.com/mtianyan/DjangoGetStarted</a><br>本节开始对应对应Github的commit：django model的增删改数据库。本次内容截止教程3-4。</p></blockquote><p>本节将介绍url的配置，以及如何将数据库数据填充回前台html页面。</p><p>情景：只允许用户修改<code>mtianyan</code>，如果没有就添加，如果有就回填使用户可以修改。</p><h3 id="取出数据"><a href="#取出数据" class="headerlink" title="取出数据"></a>取出数据</h3><p>message/views.py中的getform方法中</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">message = <span class="keyword">None</span></span><br><span class="line">all_message = UserMessage.objects.filter(name=<span class="string">'mtianyan'</span>, address=<span class="string">'西安'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># if 判断是否存在数据</span></span><br><span class="line"><span class="keyword">if</span> all_message:</span><br><span class="line">    <span class="comment"># all_message是一个list，可以使用切片。</span></span><br><span class="line">    message = all_message[<span class="number">0</span>]</span><br></pre></td></tr></table></figure><blockquote><p>这里注意把前几节写的删除掉</p></blockquote><h3 id="将数据回填至html中"><a href="#将数据回填至html中" class="headerlink" title="将数据回填至html中"></a>将数据回填至html中</h3><h4 id="修改return-render"><a href="#修改return-render" class="headerlink" title="修改return render"></a>修改return render</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">return render(request, &apos;message_form.html&apos;,&#123;</span><br><span class="line">        &quot;my_message&quot; : message</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>这里前面的”my_meassage”是我们可以自行命名的。会有一个<code>my_message</code>对象随着返回前端页面。</p></blockquote><h4 id="在前端页面中放入值。"><a href="#在前端页面中放入值。" class="headerlink" title="在前端页面中放入值。"></a>在前端页面中放入值。</h4><p>为input系列标签添加<code>value</code>: 使用<code>my_message.name</code>取到我们传递过来的<code>my_message</code>对象的属性值。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;input id=&quot;name&quot; type=&quot;text&quot; name=&quot;name&quot;  </span><br><span class="line">value=&quot;&#123;&#123; my_message.name &#125;&#125;&quot; class=&quot;error&quot; placeholder=&quot;请输入您的姓名&quot;/&gt;</span><br></pre></td></tr></table></figure><blockquote><p>请自行完成姓名，邮箱，联系地址三个<code>input</code>标签。</p></blockquote><p>为<code>textarea</code>标签添加值</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/F60Dl7jf93.png?imageslim" alt="mark"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;textarea id=&quot;message&quot; name=&quot;message&quot;  </span><br><span class="line">placeholder=&quot;请输入你的建议&quot;&gt;&#123;&#123; my_message.message &#125;&#125;&lt;/textarea&gt;</span><br></pre></td></tr></table></figure><p>运行项目，访问：<a href="http://127.0.0.1:8000/form/" target="_blank" rel="noopener">http://127.0.0.1:8000/form/</a></p><p><img src="http://myphoto.mtianyan.cn/blog/180107/27BFK0ieIL.png?imageslim" alt="mark"></p><blockquote><p>成功！！我们已经将后台数据库数据成功展示到前台。</p></blockquote><h3 id="template模板渲染中的一些用法。"><a href="#template模板渲染中的一些用法。" class="headerlink" title="template模板渲染中的一些用法。"></a>template模板渲染中的一些用法。</h3><blockquote><p>在我们的template模板中也就是form.html中，不允许我们写Python的语法，<br>它提供了一套自己的内建标签。</p></blockquote><p><a href="https://docs.djangoproject.com/en/2.0/ref/templates/builtins/" target="_blank" rel="noopener">官方文档中template内建标签用法传送门</a></p><h4 id="常用的几种模板标签介绍："><a href="#常用的几种模板标签介绍：" class="headerlink" title="常用的几种模板标签介绍："></a>常用的几种模板标签介绍：</h4><h5 id="if-else"><a href="#if-else" class="headerlink" title="if - else"></a><code>if - else</code></h5><p>官方提供模板如下：</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/mhJlLmCiLh.png?imageslim" alt="mark"></p><p>个人实践：</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/Ahch4LBcKd.png?imageslim" alt="mark"></p><p>满足if运行结果：</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/kBb2Ak6ec0.png?imageslim" alt="mark"></p><p>不满足if：如改为<code>my_message.name == &quot;mtianyan1&quot;</code>运行结果：</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/5c6fK8mDAK.png?imageslim" alt="mark"></p><h5 id="ifequal-amp-ifnotequal"><a href="#ifequal-amp-ifnotequal" class="headerlink" title="ifequal &amp; ifnotequal"></a><code>ifequal</code> &amp; <code>ifnotequal</code></h5><p><img src="http://myphoto.mtianyan.cn/blog/180107/he6fBLk1le.png?imageslim" alt="mark"></p><p>官方文档解释：<code>ifequal a b</code> 相当于<code>f a == b</code>.<code>ifnotequal</code>则相当于<code>if a != b</code></p><p>个人实践：<br><img src="http://myphoto.mtianyan.cn/blog/180107/ihKmHmCLcD.png?imageslim" alt="mark"></p><p>结果为：未找到中文昵称</p><h5 id="slice"><a href="#slice" class="headerlink" title="slice"></a>slice</h5><p><img src="http://myphoto.mtianyan.cn/blog/180107/DccKL0EB4C.png?imageslim" alt="mark"></p><p>官方文档解释：其实就是切片操作。从头开始切到第n个。</p><p>个人实践：</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/m8jJE8KEae.png?imageslim" alt="mark"></p><blockquote><p>本来<code>mtianyan</code> 与 <code>mtianyan1</code>是不同的，但是切片后前八位相同。<br>运行结果显示 ：<code>对应中文昵称：天涯明月笙</code></p></blockquote><h3 id="URl的别名设置技巧"><a href="#URl的别名设置技巧" class="headerlink" title="URl的别名设置技巧"></a>URl的别名设置技巧</h3><p>DjangoGetStarted/urls.py：</p><p>为<code>r&#39;^form/$&#39;</code>添加别名：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(<span class="string">r'^form/$'</span>, getform, name = <span class="string">"form_new"</span>)</span><br></pre></td></tr></table></figure><p>前往html中修改action地址为下面所示：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;&#123;% url &quot;form_new&quot; %&#125;&quot; method=&quot;post&quot; class=&quot;smart-green&quot;&gt;</span><br></pre></td></tr></table></figure><p>这时我们如果改动urls.py中的<code>r&#39;^form/$&#39;</code>不需要再修改前端代码中值。</p><h3 id="url先后顺序问题"><a href="#url先后顺序问题" class="headerlink" title="url先后顺序问题"></a>url先后顺序问题</h3><p><strong>注意</strong>url匹配规则中一定不要忘记<code>/$</code>符号代表以<code>form/</code>结束的才会有效。不会向后继续匹配。比如没有<code>/$</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(r&apos;^form&apos;, getform, name=&quot;form_new&quot;)</span><br></pre></td></tr></table></figure><p>这时我们进入浏览器访问时输入<code>http://127.0.0.1:8000/formemmm</code>都可以被响应。</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/aehl7G2K20.png?imageslim" alt="mark"></p><p>特别是如果底下还配置有被这个规则包含的条目，会产生被写在更靠前的拦截住得不到正确处理的Bug。</p><p><img src="http://myphoto.mtianyan.cn/blog/180107/jm5AJLLmGd.png?imageslim" alt="mark"></p><blockquote><p>上图我们是想要让formtest响应admin.site.urls。但是会被form提前拦截住。</p></blockquote><p>所以我们一定要注意加上<code>/$</code>符号。</p><p>至此我们完成了留言板项目：学习到了Django必备的基础知识。<br>下一章我们将开始我们的进阶学习：开发在线教育平台网站。</p><p>本章结束：</p><blockquote><p>对应Commit: 留言板项目学习完成，本次内容截止教程3-5。完结，撒花。<br>项目Github地址：<a href="https://github.com/mtianyan/DjangoGetStarted" target="_blank" rel="noopener">https://github.com/mtianyan/DjangoGetStarted</a></p></blockquote></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><div><div class="my_post_copyright"><script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script><script src="https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script><script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script><p><span>本文标题:</span><a href="/post/ac975bcd.html">强力Django+杀手级Xadmin打造在线教育平台(三)</a></p><p><span>文章作者:</span><a href="/" title="访问 mtianyan 的个人博客">mtianyan</a></p><p><span>发布时间:</span>2018年01月08日 - 22:01</p><p><span>最后更新:</span>2018年02月02日 - 20:02</p><p><span>原始链接:</span><a href="/post/ac975bcd.html" title="强力Django+杀手级Xadmin打造在线教育平台(三)">http://blog.mtianyan.cn/post/ac975bcd.html</a><span class="copy-path" title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="http://blog.mtianyan.cn/post/ac975bcd.html" aria-label="复制成功！"></i></span></p><p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p></div><script>var clipboard=new Clipboard(".fa-clipboard");$(".fa-clipboard").click(function(){clipboard.on("success",function(){swal({title:"",text:"复制成功",icon:"success",showConfirmButton:!0})})})</script></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>请博主吃包辣条</div> <button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'> <span>打赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"> <img id="wechat_qr" src="/images/wechatpay.png" alt="mtianyan 微信支付"><p>微信支付</p></div><div id="alipay" style="display:inline-block"> <img id="alipay_qr" src="/images/alipay.jpg" alt="mtianyan 支付宝"><p>支付宝</p></div></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Python/" rel="tag"><i class="fa fa-tag"></i> Python</a><a href="/tags/Django/" rel="tag"><i class="fa fa-tag"></i> Django</a><a href="/tags/在线教育平台/" rel="tag"><i class="fa fa-tag"></i> 在线教育平台</a></div><div class="post-widgets"><div id="needsharebutton-postbottom"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/post/d2647be6.html" rel="next" title="强力Django+杀手级Xadmin打造在线教育平台(二)"><i class="fa fa-chevron-left"></i> 强力Django+杀手级Xadmin打造在线教育平台(二)</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/post/56d4b4c2.html" rel="prev" title="强力Django+杀手级Xadmin打造在线教育平台(四)">强力Django+杀手级Xadmin打造在线教育平台(四)<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"><div class="jiathis_style"> <span class="jiathis_txt">分享到：</span> <a class="jiathis_button_fav">收藏夹</a> <a class="jiathis_button_copy">复制网址</a> <a class="jiathis_button_email">邮件</a> <a class="jiathis_button_weixin">微信</a> <a class="jiathis_button_qzone">QQ空间</a> <a class="jiathis_button_tqq">腾讯微博</a> <a class="jiathis_button_douban">豆瓣</a> <a class="jiathis_button_share">一键分享</a> <a href="http://www.jiathis.com/share?uid=2140465" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a><a class="jiathis_counter_style"></a></div><script type="text/javascript">var jiathis_config={data_track_clickback:!0,summary:"",shortUrl:!1,hideMore:!1}</script><script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=2154292" charset="utf-8"></script></div></div></div><div class="comments" id="comments"><div id="SOHUCS"></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="mtianyan"><p class="site-author-name" itemprop="name">mtianyan</p><p class="site-description motion-element" itemprop="description">爱分享，爱技术，爱生活。</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">37</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/index.html"><span class="site-state-item-count">5</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">23</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/mtianyan" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="https://www.jianshu.com/u/db9a7a0daa1f" target="_blank" title="简书"><i class="fa fa-fw fa-book"></i> 简书</a></span><span class="links-of-author-item"><a href="https://plus.google.com/u/0/114963812195952881148" target="_blank" title="Google"><i class="fa fa-fw fa-google"></i> Google</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> 友情链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="http://mtianyan.gitee.io/" title="本站孪生站(国内码云托管)" target="_blank">本站孪生站(国内码云托管)</a></li></ul></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-django目录结构"><span class="nav-number">1.</span> <span class="nav-text">3-1 django目录结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#django自动生成的目录"><span class="nav-number">1.1.</span> <span class="nav-text">django自动生成的目录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#还需要我们自己创建的目录"><span class="nav-number">1.2.</span> <span class="nav-text">还需要我们自己创建的目录</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#startapp-message"><span class="nav-number">1.2.1.</span> <span class="nav-text">startapp message</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#新建static目录"><span class="nav-number">1.2.2.</span> <span class="nav-text">新建static目录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#新建log目录"><span class="nav-number">1.2.3.</span> <span class="nav-text">新建log目录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#新建media目录"><span class="nav-number">1.2.4.</span> <span class="nav-text">新建media目录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#解决项目大了之后app过多问题"><span class="nav-number">1.2.5.</span> <span class="nav-text">解决项目大了之后app过多问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Mark后Pycharm-不报错，Cmd下运行报错。"><span class="nav-number">1.2.6.</span> <span class="nav-text">Mark后Pycharm 不报错，Cmd下运行报错。</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#github仓库项目初始化第一次commit。"><span class="nav-number">1.3.</span> <span class="nav-text">github仓库项目初始化第一次commit。</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-配置表单页面"><span class="nav-number">2.</span> <span class="nav-text">3-2 配置表单页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#必要的该说的，该了解的"><span class="nav-number">2.1.</span> <span class="nav-text">必要的该说的，该了解的</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#将html文件整合进项目操作步骤"><span class="nav-number">2.2.</span> <span class="nav-text">将html文件整合进项目操作步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#将html文件直接复制进templates目录"><span class="nav-number">2.2.1.</span> <span class="nav-text">将html文件直接复制进templates目录.</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#创建static目录下的css文件夹-和-static-js"><span class="nav-number">2.2.2.</span> <span class="nav-text">创建static目录下的css文件夹 和 static/js</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置Django连接Mysql数据库"><span class="nav-number">2.3.</span> <span class="nav-text">配置Django连接Mysql数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#配置mysql驱动和seeting文件。"><span class="nav-number">2.3.1.</span> <span class="nav-text">配置mysql驱动和seeting文件。</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置form页面展示出来："><span class="nav-number">2.4.</span> <span class="nav-text">配置form页面展示出来：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#项目配置流程图"><span class="nav-number">2.5.</span> <span class="nav-text">项目配置流程图</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-django-orm介绍与model设计"><span class="nav-number">3.</span> <span class="nav-text">3-3 django orm介绍与model设计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#原生sql-与-orm"><span class="nav-number">3.1.</span> <span class="nav-text">原生sql 与 orm</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建我们的models"><span class="nav-number">3.2.</span> <span class="nav-text">创建我们的models</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#在setting中注册我们的app"><span class="nav-number">3.3.</span> <span class="nav-text">在setting中注册我们的app</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Models讲解"><span class="nav-number">3.4.</span> <span class="nav-text">Models讲解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#介绍字段参数"><span class="nav-number">3.4.1.</span> <span class="nav-text">介绍字段参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#介绍Meta信息："><span class="nav-number">3.4.2.</span> <span class="nav-text">介绍Meta信息：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-django-model的增删改"><span class="nav-number">4.</span> <span class="nav-text">3-4 django model的增删改</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#filter取出指定要求值"><span class="nav-number">4.1.</span> <span class="nav-text">filter取出指定要求值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#将数据存入数据库"><span class="nav-number">4.2.</span> <span class="nav-text">将数据存入数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Navicat进行验证"><span class="nav-number">4.3.</span> <span class="nav-text">Navicat进行验证</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何从html的提交中取到数据并保存进数据库"><span class="nav-number">4.4.</span> <span class="nav-text">如何从html的提交中取到数据并保存进数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据库新增。"><span class="nav-number">4.5.</span> <span class="nav-text">数据库新增。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除数据。"><span class="nav-number">4.6.</span> <span class="nav-text">删除数据。</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5-django-url-templates配置"><span class="nav-number">5.</span> <span class="nav-text">3-5 django url templates配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#取出数据"><span class="nav-number">5.1.</span> <span class="nav-text">取出数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#将数据回填至html中"><span class="nav-number">5.2.</span> <span class="nav-text">将数据回填至html中</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#修改return-render"><span class="nav-number">5.2.1.</span> <span class="nav-text">修改return render</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#在前端页面中放入值。"><span class="nav-number">5.2.2.</span> <span class="nav-text">在前端页面中放入值。</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#template模板渲染中的一些用法。"><span class="nav-number">5.3.</span> <span class="nav-text">template模板渲染中的一些用法。</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#常用的几种模板标签介绍："><span class="nav-number">5.3.1.</span> <span class="nav-text">常用的几种模板标签介绍：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#if-else"><span class="nav-number">5.3.1.1.</span> <span class="nav-text">if - else</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ifequal-amp-ifnotequal"><span class="nav-number">5.3.1.2.</span> <span class="nav-text">ifequal &amp; ifnotequal</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#slice"><span class="nav-number">5.3.1.3.</span> <span class="nav-text">slice</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#URl的别名设置技巧"><span class="nav-number">5.4.</span> <span class="nav-text">URl的别名设置技巧</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#url先后顺序问题"><span class="nav-number">5.5.</span> <span class="nav-text">url先后顺序问题</span></a></li></ol></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright">&copy; 2015 &mdash; <span itemprop="copyrightYear">2018</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">mtianyan</span><div class="theme-info"><div class="powered-by"></div> <span class="post-count">博客全站共182.8k字</span></div></div><div class="busuanzi-count"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script> <span class="site-uv">本站访客数<span class="busuanzi-value" id="busuanzi_value_site_uv"></span> 人次</span> <span class="site-pv">本站总访问量<span class="busuanzi-value" id="busuanzi_value_site_pv"></span> 次</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div><div id="needsharebutton-float"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script><script type="text/javascript">!function(){var t="1eb79150519fd9b791c77e8eef6f3632";if((window.innerWidth||document.documentElement.clientWidth)<960)window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=cyrJmJ3rL&conf='+t+'"><\/script>');else{!function(t,e){var n=document.getElementsByTagName("head")[0]||document.head||document.documentElement,a=document.createElement("script");a.setAttribute("type","text/javascript"),a.setAttribute("charset","UTF-8"),a.setAttribute("src",t),"function"==typeof e&&(window.attachEvent?a.onreadystatechange=function(){var t=a.readyState;"loaded"!==t&&"complete"!==t||(a.onreadystatechange=null,e())}:a.onload=e),n.appendChild(a)}("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:"cyrJmJ3rL",conf:t})})}}()</script><script type="text/javascript" src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js"></script><script type="text/javascript">var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")};function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){var r=!1,s=0,a=0,i=n.title.trim(),c=i.toLowerCase(),l=n.content.trim().replace(/<[^>]+>/g,""),h=l.toLowerCase(),p=decodeURIComponent(n.url),u=[],f=[];if(""!=i&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}u=u.concat(e(t,c,!1)),f=f.concat(e(t,h,!1))}),(u.length>0||f.length>0)&&(r=!0,s=u.length+f.length)),r){[u,f].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});function d(e,o,n,r){for(var s=r[r.length-1],i=s.position,c=s.word,l=[],h=0;i+c.length<=n&&0!=r.length;){c===t&&h++,l.push({position:i,length:c.length});var p=i+c.length;for(r.pop();0!=r.length&&(i=(s=r[r.length-1]).position,c=s.word,p>i);)r.pop()}return a+=h,{hits:l,start:o,end:n,searchTextCount:h}}var g=[];0!=u.length&&g.push(d(0,0,i.length,u));for(var v=[];0!=f.length;){var $=f[f.length-1],C=$.position,m=$.word,x=C-20,w=C+80;x<0&&(x=0),w<C+m.length&&(w=C+m.length),w>l.length&&(w=l.length),v.push(d(0,x,w,f))}v.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var y=parseInt("1");y>=0&&(v=v.slice(0,y));function T(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var b="";0!=g.length?b+="<li><a href='"+p+"' class='search-result-title'>"+T(i,g[0])+"</a>":b+="<li><a href='"+p+"' class='search-result-title'>"+i+"</a>",v.forEach(function(t){b+="<a href='"+p+'\'><p class="search-result">'+T(l,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:a,hitCount:s,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),!1===isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){27===t.which&&$(".search-popup").is(":visible")&&onPopupClose()})</script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script><script>AV.initialize("2uqmIjYredIvFy6tEXbKG4Fj-gzGzoHsz","CWl1rE8cQlIseOg2Cq3hzxYi")</script><script>function showTime(e){var t=new AV.Query(e),n=[],o=$(".leancloud_visitors");o.each(function(){n.push($(this).attr("id").trim())}),t.containedIn("url",n),t.find().done(function(e){var t=".leancloud-visitors-count";if(0!==e.length){for(var i=0;i<e.length;i++){var s=e[i],r=s.get("url"),l=s.get("time"),c=document.getElementById(r);$(c).find(t).text(l)}for(i=0;i<n.length;i++){r=n[i],c=document.getElementById(r);var u=$(c).find(t);""==u.text()&&u.text(0)}}else o.find(t).text(0)}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(e){var t=$(".leancloud_visitors"),n=t.attr("id").trim(),o=t.attr("data-flag-title").trim(),i=new AV.Query(e);i.equalTo("url",n),i.find({success:function(t){if(t.length>0){var i=t[0];i.fetchWhenSave(!0),i.increment("time"),i.save(null,{success:function(e){$(document.getElementById(n)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var s=new e,r=new AV.ACL;r.setPublicReadAccess(!0),r.setPublicWriteAccess(!0),s.setACL(r),s.set("title",o),s.set("url",n),s.set("time",1),s.save(null,{success:function(e){$(document.getElementById(n)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):$(".post-title-link").length>1&&showTime(e)})</script><link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css"><script src="/lib/needsharebutton/needsharebutton.js"></script><script>pbOptions={},pbOptions.iconStyle="default",pbOptions.boxForm="horizontal",pbOptions.position="bottomCenter",pbOptions.networks="Weibo,Wechat,Douban,QQZone,Twitter,Facebook",new needShareButton("#needsharebutton-postbottom",pbOptions),flOptions={},flOptions.iconStyle="default",flOptions.boxForm="horizontal",flOptions.position="middleRight",flOptions.networks="Weibo,Wechat,Douban,QQZone,Twitter,Facebook",new needShareButton("#needsharebutton-float",flOptions)</script><script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script><script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script><script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><div id="hexo-helper-live2d"><canvas id="live2dcanvas" width="150" height="300"></canvas></div><style>#live2dcanvas{position:fixed;width:150px;height:300px;opacity:.7;right:-30px;z-index:999;pointer-events:none;bottom:40px}</style><script type="text/javascript" src="/live2d/device.min.js"></script><script type="text/javascript">
const loadScript = function loadScript(c,b){var a=document.createElement("script");a.type="text/javascript";"undefined"!=typeof b&&(a.readyState?a.onreadystatechange=function(){if("loaded"==a.readyState||"complete"==a.readyState)a.onreadystatechange=null,b()}:a.onload=function(){b()});a.src=c;document.body.appendChild(a)};
(function(){
  if((typeof(device) != 'undefined') && (device.mobile())){
    var trElement = document.getElementById('hexo-helper-live2d');
    trElement.parentNode.removeChild(trElement);
    return;
  }else
    if (typeof(device) === 'undefined') console.error('Cannot find current-device script.');
  loadScript("/live2d/script.js", function(){loadlive2d("live2dcanvas", "/live2d/assets/hijiki.model.json", 0.5);});
})();
</script></body></html><script type="text/javascript" src="/js/src/love.js"></script>