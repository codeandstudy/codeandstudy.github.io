<!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script></script><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3"><link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222"><meta name="keywords" content="Python,文件处理,专题笔记,"><link rel="alternate" href="/atom.xml" title="mtianyan's blog" type="application/atom+xml"><meta name="description" content="走近Linux之走近文件    任何语言都离不开对文件的操作，Python语言是如何来操作和管理文件的。掌握文件的基本概念、基本操作，了解文件属性、 linux 系统的文件管理机制及os模块对文件和目录的处理等相关内容。  [√]慕课网Meshare_huang老师：Python文件处理"><meta name="keywords" content="Python,文件处理,专题笔记"><meta property="og:type" content="article"><meta property="og:title" content="Python文件处理-专题笔记"><meta property="og:url" content="http://blog.mtianyan.cn/post/deaf66c8.html"><meta property="og:site_name" content="mtianyan&#39;s blog"><meta property="og:description" content="走近Linux之走近文件    任何语言都离不开对文件的操作，Python语言是如何来操作和管理文件的。掌握文件的基本概念、基本操作，了解文件属性、 linux 系统的文件管理机制及os模块对文件和目录的处理等相关内容。  [√]慕课网Meshare_huang老师：Python文件处理"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180105/ja9K6H3IF2.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180105/8h45alB3E2.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180105/cl7b7hk3I8.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180105/a2mgcm26Ij.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180105/6ceahk4A44.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/bl7dk5hJh6.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/9mEAieLhhB.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/jClleHm2L3.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/8LlgeBbeF1.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/jeihD8Fk7d.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/bCBh622gFI.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/dBiFhaIaFD.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/lBDelEdGgl.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/EhilmC7AHd.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/8BIFGCB5ge.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/kh5BdJIF4h.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/DJIDC4CcGE.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/03d8LcbEd0.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/HiG3agaJdg.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/C6k1K0ihlJ.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/Ab332e9280.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/Jd54A7e7jf.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/27gh2mdJI2.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/2mGhG36mk0.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/FI1l8ggadI.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/7agEmLFl9K.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/l6FdaaKaAL.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/Ke4CkfKaiC.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/b33936E4h7.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/8hddlFCjDk.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/LLDgdC8AIc.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/C73B4A1gIc.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/8iIjg1LI07.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/12m2BBaiD8.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/f5HcLchgiF.png?imageslim"><meta property="og:image" content="http://myphoto.mtianyan.cn/blog/180106/I0167hf15I.png?imageslim"><meta property="og:updated_time" content="2018-02-02T12:40:13.956Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Python文件处理-专题笔记"><meta name="twitter:description" content="走近Linux之走近文件    任何语言都离不开对文件的操作，Python语言是如何来操作和管理文件的。掌握文件的基本概念、基本操作，了解文件属性、 linux 系统的文件管理机制及os模块对文件和目录的处理等相关内容。  [√]慕课网Meshare_huang老师：Python文件处理"><meta name="twitter:image" content="http://myphoto.mtianyan.cn/blog/180105/ja9K6H3IF2.png?imageslim"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"5.1.3",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!0,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://blog.mtianyan.cn/post/deaf66c8.html"><script>!function(e,t,o,c,i,a,n){e.DaoVoiceObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,a=t.createElement("script"),n=t.getElementsByTagName("script")[0],a.async=1,a.src=c,a.charset="utf-8",n.parentNode.insertBefore(a,n)}(window,document,0,("https:"==document.location.protocol?"https:":"http:")+"//widget.daovoice.io/widget/0f81ff2f.js","daovoice"),daovoice("init",{app_id:"e28768be"}),daovoice("update")</script><title>Python文件处理-专题笔记 | mtianyan's blog</title><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?415372bd35fec36f7558dd96b48ec03f";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div> <a href="https://github.com/mtianyan" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">mtianyan's blog</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">天涯明月笙的博客小站(Github托管)</p></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="menu-item-icon fa fa-fw fa-heartbeat"></i><br> 公益404</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br> 搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://blog.mtianyan.cn/post/deaf66c8.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="mtianyan"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="mtianyan's blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Python文件处理-专题笔记</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-05T23:02:40+08:00">2018-01-05</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python从入门到精通/" itemprop="url" rel="index"><span itemprop="name">python从入门到精通</span></a></span></span> <span id="/post/deaf66c8.html" class="leancloud_visitors" data-flag-title="Python文件处理-专题笔记"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">热度&#58;</span><span class="leancloud-visitors-count"></span> <span>℃</span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">5,562</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">24</span></div></div></header><div class="post-body" itemprop="articleBody"><blockquote class="blockquote-center"><p>走近Linux之走近文件</p></blockquote><div class="note"><p> 任何语言都离不开对文件的操作，Python语言是如何来操作和管理文件的。掌握文件的基本概念、基本操作，了解文件属性、 linux 系统的文件管理机制及os模块对文件和目录的处理等相关内容。</p><ul><li>[√]慕课网Meshare_huang老师：Python文件处理</li></ul></div><a id="more"></a><p><img src="http://myphoto.mtianyan.cn/blog/180105/ja9K6H3IF2.png?imageslim" alt="mark"></p><h1 id="文件简介"><a href="#文件简介" class="headerlink" title="文件简介"></a>文件简介</h1><p>Python的文件处理:</p><p>初学者：推荐使用虚拟机<code>VMwareStation</code> + <code>Deepin</code></p><p>必备前置条件知识储备：</p><ol><li>Linux系统知识</li><li>Linux下Python开发环境</li><li>掌握Python基础知识</li></ol><p>Python文件概念：</p><p>文件： Python中文件是<strong>对象</strong>依赖我们的具体系统。</p><p>Linux文件：<strong>一切设备都可以看成文件</strong></p><ul><li>例如：磁盘文件，管道，网络Socket，外设等。</li></ul><p>文件属性：<code>用户</code>，<code>读</code>，<code>写</code>，<code>执行权限</code>；</p><p>在Linux控制台输入命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#cd进一个空目录</span><br><span class="line">cd Desktop/ </span><br><span class="line">#创建一个文件夹</span><br><span class="line">mkdir PythonFile </span><br><span class="line">cd PythonFile </span><br><span class="line">touch hello.py</span><br><span class="line">vim hello.py</span><br></pre></td></tr></table></figure><p><img src="http://myphoto.mtianyan.cn/blog/180105/8h45alB3E2.png?imageslim" alt="mark"></p><p>使用<code>i</code>进入<code>insert模式</code>进行插入代码。<br>插入完成后使用<code>esc</code>退出编辑模式，输入<code>:wq</code>进行保存。</p><p><img src="http://myphoto.mtianyan.cn/blog/180105/cl7b7hk3I8.png?imageslim" alt="mark"></p><p><img src="http://myphoto.mtianyan.cn/blog/180105/a2mgcm26Ij.png?imageslim" alt="mark"></p><p>通过<code>ls -l</code>命令可以看到文件的一些基本属性：</p><ul><li>第一个横杠代表是一个文件，还是一个目录。<code>-</code>代表是一个文件，<code>d</code>代表是一个目录<br>如下图1为一个目录。<br><img src="http://myphoto.mtianyan.cn/blog/180105/6ceahk4A44.png?imageslim" alt="mark"></li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180106/bl7dk5hJh6.png?imageslim" alt="mark"></p><ul><li>第一组<code>rw-</code>代表当前用户对于当前文件有<code>读</code>有<code>写</code>没有<code>执行权限</code>。(<code>-</code>代表没有权限，<code>x</code>为可执行)</li><li>第二组<code>r--</code>：表示当前用户组对该文件有<code>读r</code> 没有<code>写w</code>的权限，没有<code>执行权限x</code></li><li><p>第三组<code>r--</code>：表示其他用户对该文件有<code>读r</code>权限，但没有<code>写w</code>和<code>执行x</code>权限</p></li><li><p>第一个<code>mtianyan</code>代表文件的<strong>拥有者</strong>是<code>mtianyan</code></p></li><li>第二个<code>mtianyan</code> 代表这个文件所属的<strong>用户组</strong>是<code>mtianyan</code></li><li><code>21</code>代表文件的大小是<code>21字节</code> 后面的时间是文件的创建时间。后面是文件名。</li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180106/9mEAieLhhB.png?imageslim" alt="mark"></p><p>可以看到我们最为<strong>当前用户</strong>现在没有该文件执行权限。</p><p>使用<code>chmod</code>为文件<strong>增加权限</strong>说明：</p><ul><li>如果给所有人添加可执行权限：<code>chmod a+x 文件名</code>；</li><li>如果给文件所有者添加可执行权限：<code>chmod u+x 文件名</code>；</li><li>如果给所在组添加可执行权限：<code>chmod g+x 文件名</code>；</li><li>如果给所在组以外的人添加可执行权限：<code>chmod o+x 文件名</code>；</li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180106/jClleHm2L3.png?imageslim" alt="mark"></p><p>可以看到我们通过<code>chmod +x hello.py</code>为当前<code>用户</code>，<code>用户组</code>，<code>其他用户</code>都添加了执行权限</p><p>Linux下首行一定要加这句话：<code>!/usr/bin/Python</code>，<code>!/usr/bin/Python</code>是告诉操作系统执行这个脚本的时候，调用<code>/usr/bin</code>下的python解释器。</p><p><img src="http://myphoto.mtianyan.cn/blog/180106/8LlgeBbeF1.png?imageslim" alt="mark"></p><p>打印出了<code>Helloworld</code>好像有点问题。以后对Linux熟了再回来看。</p><p><img src="http://myphoto.mtianyan.cn/blog/180106/jeihD8Fk7d.png?imageslim" alt="mark"></p><p><code>python</code>命令是可以正常执行的。</p><h1 id="文件基础操作"><a href="#文件基础操作" class="headerlink" title="文件基础操作"></a>文件基础操作</h1><p>主要讲解文件打开及文件不同的打开方式、使用<code>read</code>,<code>readlines</code>及<code>迭代器</code>访问文件、文件写入方式及<code>写缓存</code>处理、文件关闭及由不关闭导致的问题、文件指针及文件指针操作</p><h2 id="文件打开方式"><a href="#文件打开方式" class="headerlink" title="文件打开方式"></a>文件打开方式</h2><h3 id="open"><a href="#open" class="headerlink" title="open()"></a>open()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open(name [,mode[buf]])</span><br></pre></td></tr></table></figure><ul><li><code>name</code> : 文件路径</li><li><code>mode</code> : 打开方式</li><li><code>buf</code> : 缓冲buffering大小</li></ul><p><code>mode</code>方式有：<code>只读</code>，<code>只写</code>。<code>读写</code>。</p><h3 id="read"><a href="#read" class="headerlink" title="read()"></a>read()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">read([size])</span><br></pre></td></tr></table></figure><p>读取文件(读取<code>size个字节</code>，默认读取全部)</p><ul><li>如果文件长度大于size，我们就读size个长度。</li><li>如果文件长度小于size，我们就把文件读完。</li><li>如果没有设置size，默认全部读完。</li></ul><h3 id="readline"><a href="#readline" class="headerlink" title="readline()"></a>readline()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">readline([size])</span><br></pre></td></tr></table></figure><p>读取一行</p><h3 id="readlines"><a href="#readlines" class="headerlink" title="readlines()"></a>readlines()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">readlines([size])</span><br></pre></td></tr></table></figure><p>读取完文件(看到后面你就知道并不是)，返回每一行所组成的列表。我们就可以使用列表访问的方式，使用文件。</p><p>弊端：一次性读完，占用很大内存。</p><h3 id="write"><a href="#write" class="headerlink" title="write()"></a>write()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">write(str)</span><br></pre></td></tr></table></figure><p>将字符串写入文件</p><h3 id="writelines"><a href="#writelines" class="headerlink" title="writelines()"></a>writelines()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">writelines(sequence_of_strings) : 写多行到文件</span><br></pre></td></tr></table></figure><p><code>sequence_of_strings</code>是一个由字符型组成的列表。一次性写入多行。</p><p>输入<code>ipython</code>进入ipython环境</p><p><img src="http://myphoto.mtianyan.cn/blog/180106/bCBh622gFI.png?imageslim" alt="mark"></p><p><code>type(f)</code>可以看到打开的文件类型就是一个文件对象。</p><p><img src="http://myphoto.mtianyan.cn/blog/180106/dBiFhaIaFD.png?imageslim" alt="mark"></p><p>拥有的方法可以使用<code>f.</code> + <code>Tab</code>自动补齐</p><p><img src="http://myphoto.mtianyan.cn/blog/180106/lBDelEdGgl.png?imageslim" alt="mark"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error：File not open for writing</span><br></pre></td></tr></table></figure><p>这里因为我们使用的是<strong>默认无参数打开，此时我们并不拥有写权限。</strong></p><p>Python文件打开方式</p><table><thead><tr><th>mode</th><th>说明</th><th>说明</th></tr></thead><tbody><tr><td>‘r’</td><td>只读方式打开</td><td>文件必须存在</td></tr><tr><td>‘w’</td><td>只写方式打开</td><td>文件不存在创建文件;存在则清空内容</td></tr><tr><td>‘a’</td><td>追加方式打开</td><td>文件不存在创建文件</td></tr><tr><td>‘r+’/‘W+’</td><td>读写方式打开</td><td></td></tr><tr><td>‘a+’</td><td>追加和读写方式打开</td></tr></tbody></table><p><code>&#39;rb&#39;</code>,<code>&#39;wb&#39;</code>,<code>&#39;ab&#39;</code>,<code>&#39;rb+&#39;</code>,<code>&#39;wb+&#39;</code>,<code>&#39;ab+&#39;</code>:都是采用二进制方式打开。</p><h3 id="练习-39-r-39-39-w-39-39-a-39-39-r-39"><a href="#练习-39-r-39-39-w-39-39-a-39-39-r-39" class="headerlink" title="练习&#39;r&#39; &#39;w&#39; &#39;a&#39; &#39;r+&#39;"></a>练习<code>&#39;r&#39;</code> <code>&#39;w&#39;</code> <code>&#39;a&#39;</code> <code>&#39;r+&#39;</code></h3><p><img src="http://myphoto.mtianyan.cn/blog/180106/EhilmC7AHd.png?imageslim" alt="mark"></p><ul><li><strong>不带参数</strong>的<code>open</code>是用<strong>只读</strong>方式打开的，所以文件<strong>不存在会报错</strong>。</li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180106/8BIFGCB5ge.png?imageslim" alt="mark"></p><ul><li>请<strong>注意关闭</strong>文件<code>f.close()</code>否则<code>cat</code>时文件内容会为空。</li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180106/kh5BdJIF4h.png?imageslim" alt="mark"></p><ul><li>当我们<strong>再次</strong>打开文件使用<code>w</code>方式。已存在的文件会被<strong>清空</strong>才打开。</li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180106/DJIDC4CcGE.png?imageslim" alt="mark"></p><ul><li>我们以<code>a</code>方式打开此时我们可以对于文件进行<strong>追加</strong>操作，原有内容并没有被清空<br>新增内容被添加到了<strong>最后</strong>。</li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180106/03d8LcbEd0.png?imageslim" alt="mark"></p><ul><li>当我们以<code>r+</code>方式打开，我们新增的内容会从<strong>文件开始</strong>替换原有内容的一部分。</li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180106/HiG3agaJdg.png?imageslim" alt="mark"></p><ul><li>当我们以<code>w+</code>方式打开，文件可以被<strong>读写</strong>。但是文件内容被清空。</li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180106/C6k1K0ihlJ.png?imageslim" alt="mark"></p><ul><li>此时新文件可以被读写。</li></ul><p>使用二进制方式打开的使用方法与上面介绍的基本一致。</p><p>意义在于： <strong>比如读取一张图片的EXIF信息读取图片的长宽拍照日期</strong></p><p>如果我们以普通方式打开是以文本方式打开，不能读取到正确的内容。<br>当我们以二进制打开我们就可以读取到正确的<code>EXIF信息</code>。</p><p>学习了打开文件，读取文件，写入文件。文件打开方式的不同。</p><h2 id="文件读取方式"><a href="#文件读取方式" class="headerlink" title="文件读取方式"></a>文件读取方式</h2><h3 id="read-1"><a href="#read-1" class="headerlink" title="read()"></a>read()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">read([size])</span><br></pre></td></tr></table></figure><p>读取文件(读取<code>size个字节</code>，默认读取全部)</p><ul><li>如果文件长度大于size，我们就读size个长度。</li><li>如果文件长度小于size，我们就把文件读完。</li><li>如果没有设置size，默认全部读完。</li></ul><h3 id="readline-1"><a href="#readline-1" class="headerlink" title="readline()"></a>readline()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">readline([size])</span><br></pre></td></tr></table></figure><p>读取一行</p><h4 id="示例操作"><a href="#示例操作" class="headerlink" title="示例操作"></a>示例操作</h4><p>首先使用<code>touch mtianyan.txt</code> 和 <code>vi mtianyan.txt</code><br>创建并写入内容：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">blog.mtianyan.cn</span><br><span class="line">blog.mtianyan.cn</span><br><span class="line">blog.mtianyan.cn</span><br></pre></td></tr></table></figure><p><img src="http://myphoto.mtianyan.cn/blog/180106/Ab332e9280.png?imageslim" alt="mark"></p><p>可以看出</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">readline(size):</span><br><span class="line">	<span class="keyword">if</span> len(line) &gt; size:</span><br><span class="line">		<span class="keyword">return</span> size</span><br><span class="line">	<span class="keyword">if</span> len(line) &lt; size:</span><br><span class="line">		<span class="keyword">return</span> len(line)</span><br></pre></td></tr></table></figure><h3 id="readlines-1"><a href="#readlines-1" class="headerlink" title="readlines()"></a>readlines()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">readlines([size])</span><br></pre></td></tr></table></figure><p>读取完文件(整数个buffer左右字节)，返回每一行所组成的列表。我们就可以使用列表访问的方式，使用文件。</p><p>弊端：一次性读完，占用很大内存。</p><h4 id="示例操作："><a href="#示例操作：" class="headerlink" title="示例操作："></a>示例操作：</h4><p><img src="http://myphoto.mtianyan.cn/blog/180106/Jd54A7e7jf.png?imageslim" alt="mark"></p><p>虽然设置了<code>size</code>为<code>1</code>,但是还是把所有都读出来了。</p><p><img src="http://myphoto.mtianyan.cn/blog/180106/27gh2mdJI2.png?imageslim" alt="mark"></p><p>输入<code>help(f.readlines)</code>查看定义：重复的调用<code>readline()</code>然后返回一个读到的行所组成的列表。</p><p>读取文件的大小：</p><ul><li>如果<code>size</code>小于<code>缓冲区</code>的大小，则读取<code>缓冲区大小</code>的数据</li><li>如果<code>size</code>大于<code>缓冲区</code>的大小，读取<code>size大小</code>的数据，但不是完全的等于size的大小，一般读取比size大的整行的数据.</li></ul><p>这个设置是python解释器内部的一个变量。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line">io.DEFAULT_BUFFER_SIZE</span><br></pre></td></tr></table></figure><p><img src="http://myphoto.mtianyan.cn/blog/180106/2mGhG36mk0.png?imageslim" alt="mark"></p><p>设置参数小于<code>8192</code>每次能读取<code>8192</code>个字节。</p><ul><li>设置参数<code>大于</code>一个<code>8192</code>小于<code>2*8192=16384</code>。则读取两个<code>buffer</code>值.</li><li><code>BUFFER</code>都是一整个一整个读</li></ul><h4 id="Linux命令使用"><a href="#Linux命令使用" class="headerlink" title="Linux命令使用"></a>Linux命令使用</h4><p>使用<code>vi</code>打开文件。<code>y</code>是复制当前行，<code>yy</code>是复制光标所在的一整行.<br>如果复制了一行，则<code>p</code>是在光标所在行的下一行粘贴，<code>10000p</code>就是粘贴10000次</p><ul><li><p>命令<code>yy，10000p</code>复制<code>10000</code>行 .然后<code>:set nu</code> 显示行数</p></li><li><p><code>gg</code>：</p><ul><li>跳转到文件头 <code>:1</code> 或 <code>gg</code></li><li>跳转到<code>文件末尾行数+gg</code> <code>:$</code> <code>Shift+g</code></li><li>跳转到指定行,例跳转到123行：<code>123gg</code>或<code>:123</code>.</li></ul></li></ul><p>使用<code>ctrl+z</code>可将程序切换到后台。用<code>fg</code>可将后台程序切换到前台。</p><p><img src="http://myphoto.mtianyan.cn/blog/180106/FI1l8ggadI.png?imageslim" alt="mark"></p><p>可以看到此时的文件以及有十几万个字节了</p><p><img src="http://myphoto.mtianyan.cn/blog/180106/7agEmLFl9K.png?imageslim" alt="mark"></p><p>可以看出这时候不再是一次性把文件读取完了，而是读取了<code>482</code>行。</p><p><code>170051/100003</code>行，每行<code>17</code>个字节。</p><p><img src="http://myphoto.mtianyan.cn/blog/180106/l6FdaaKaAL.png?imageslim" alt="mark"></p><p>这时我们的<code>size</code>大于了缓冲区的大小<code>8192</code>。因此我们的<code>size</code>到了<code>8192</code>和<code>16384</code><br>之间。</p><p><strong>重点：系统数据是按着<code>整个buffer，整个buffer</code>来读的。此时系统会读取差不多<code>两个buffer</code>的数据。也就是<code>963*17 =16371</code> 。</strong></p><p>待探究</p><h4 id="iter-使用迭代器读取文件"><a href="#iter-使用迭代器读取文件" class="headerlink" title="iter: 使用迭代器读取文件"></a>iter: 使用迭代器读取文件</h4><p><img src="http://myphoto.mtianyan.cn/blog/180106/Ke4CkfKaiC.png?imageslim" alt="mark"></p><p>迭代器并不是把我们的文件全部存入了内存中。而是我们<strong>每使用一次<code>next</code>方法就会自动读取下一行。</strong>所以能在不消耗大量内存的情况下进行读取整个文件。</p><h2 id="文件写入与写缓存"><a href="#文件写入与写缓存" class="headerlink" title="文件写入与写缓存"></a>文件写入与写缓存</h2><h3 id="write-1"><a href="#write-1" class="headerlink" title="write()"></a>write()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">write(str)</span><br></pre></td></tr></table></figure><p>将字符串写入文件</p><h3 id="writelines-1"><a href="#writelines-1" class="headerlink" title="writelines()"></a>writelines()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">writelines(sequence_of_strings) : 写多行到文件</span><br></pre></td></tr></table></figure><p><code>sequence_of_strings</code>参数是一个<code>可迭代对象</code>:</p><ul><li>可以是字符串</li><li>可以是字符串所组成的元组。</li><li>可以是一个字符串所组成的迭代器。</li><li>也可是一个字符串组成的列表</li></ul><h3 id="实际操作"><a href="#实际操作" class="headerlink" title="实际操作"></a>实际操作</h3><p><img src="http://myphoto.mtianyan.cn/blog/180106/b33936E4h7.png?imageslim" alt="mark"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">37</span>]: cat test.txt</span><br><span class="line">test write</span><br><span class="line">In [<span class="number">38</span>]: f = open(<span class="string">"mtianyan.txt"</span>,<span class="string">'w'</span>)</span><br><span class="line">In [<span class="number">39</span>]: f.writelines(<span class="string">'123456'</span>)</span><br><span class="line">In [<span class="number">40</span>]: f.writelines((<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-40</span><span class="number">-0</span>a3726375675&gt; <span class="keyword">in</span> &lt;module&gt;()</span><br><span class="line">----&gt; 1 f.writelines((1,2,3))</span><br><span class="line"></span><br><span class="line">TypeError: writelines() argument must be a sequence of strings</span><br></pre></td></tr></table></figure><p>写入一个元组会报错 ：<strong>提示必须是由字符串组成的序列。</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">41</span>]: f.writelines((<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>))</span><br><span class="line">In [<span class="number">42</span>]: f.writelines([<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>])</span><br><span class="line">In [<span class="number">43</span>]: f.close()</span><br><span class="line">In [<span class="number">44</span>]: cat test.txt</span><br><span class="line">test write</span><br><span class="line">In [<span class="number">45</span>]: cat mtianyan.txt</span><br><span class="line"><span class="number">123456123123</span></span><br></pre></td></tr></table></figure><p>可以看到我们都可以正常的写入由字符串组成的列表。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">46</span>]: f = open(<span class="string">"mtianyan.txt"</span>,<span class="string">'w'</span>)</span><br><span class="line">In [<span class="number">47</span>]: f.write(<span class="string">"11111"</span>)</span><br><span class="line">In [<span class="number">48</span>]: cat mtianyan.txt</span><br><span class="line"></span><br><span class="line">In [<span class="number">49</span>]:</span><br></pre></td></tr></table></figure><p>文件内容为空，因为我们没有使用<code>f.close()</code>将文件关闭。</p><p>Linux系统有一种<strong>写缓存机制</strong>。如果我们不主动调用<code>f.close()</code>或 <code>flush</code><br>他是不会写到磁盘文件的。</p><p><img src="http://myphoto.mtianyan.cn/blog/180106/8hddlFCjDk.png?imageslim" alt="mark"></p><p>写文件的过程中Python解释器进行<strong>系统调用</strong>。Linux系统内核将文件写入系统文件缓冲区。<br>当我们调用<code>f.close()</code>时，系统会更新文件到硬盘。</p><p>Python写磁盘的缓存机制</p><ol><li>主动调用<code>closed()</code>或<code>flush</code>方法。写缓存同步到磁盘</li><li>写入数据量大于或等于写缓存，写缓存同步到磁盘。（此时系统写缓存又清空，然后就又继续缓存直到<code>close()</code>)</li></ol><h4 id="实际操作-1"><a href="#实际操作-1" class="headerlink" title="实际操作"></a>实际操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">62</span>]: f = open(<span class="string">"mtianyan.txt"</span>,<span class="string">'w'</span>)</span><br><span class="line">In [<span class="number">63</span>]: f.write(<span class="string">'test write'</span>)</span><br><span class="line">In [<span class="number">64</span>]: cat mtianyan.txt</span><br><span class="line">In [<span class="number">65</span>]: f.flush()</span><br><span class="line">In [<span class="number">66</span>]: cat mtianyan.txt</span><br><span class="line">test write</span><br></pre></td></tr></table></figure><p>进行<code>flush()</code>操作时内容更新。</p><p><img src="http://myphoto.mtianyan.cn/blog/180106/LLDgdC8AIc.png?imageslim" alt="mark"></p><p><img src="http://myphoto.mtianyan.cn/blog/180106/C73B4A1gIc.png?imageslim" alt="mark"></p><p>说明我的Linux的缓冲区就是这么大<code>147456</code><br>当我们执行<code>close</code>文件会变大。因为全部写进去了。</p><h2 id="文件关闭"><a href="#文件关闭" class="headerlink" title="文件关闭"></a>文件关闭</h2><ol><li>将<strong>写缓存</strong>同步到磁盘；</li><li>linux系统中每个进程<strong>打开的文件个数是有限的；</strong></li><li>如果打开文件数到了系统限制，在打开文件就会失败；</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mtianyan@mtianyan-deep:~/Desktop/PythonFile$ ps</span><br><span class="line">   PID TTY          TIME CMD</span><br><span class="line">  5587 pts/1    00:00:00 bash</span><br><span class="line">  5918 pts/1    00:00:02 ipython</span><br></pre></td></tr></table></figure><p>看到ipython进程：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mtianyan@mtianyan-deep:~/Desktop/PythonFile$ cat /proc/5918/limits </span><br><span class="line">Limit                     Soft Limit           Hard Limit           Units     </span><br><span class="line">Max open files            1024                 1048576              files</span><br></pre></td></tr></table></figure><ul><li><code>file.fileno()</code>:文件描述符；每打开一个就会加1，直到1024失败<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">n [3]: for i in range(1027):</span><br><span class="line">   ...:     f = open(&quot;mtianyan.txt&quot;,&apos;r&apos;)</span><br><span class="line">   ...:     print (&quot;%d：%d&quot; %(i,f.fileno()))</span><br></pre></td></tr></table></figure></li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180106/8iIjg1LI07.png?imageslim" alt="mark"></p><p>并没有起到效果。<code>fileno</code>在<code>10</code>和<code>12</code>不断来回</p><p>实现代码:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">In [<span class="number">11</span>]: <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1025</span>):</span><br><span class="line">    ...:     list_f.append(open(<span class="string">"mtianyan.txt"</span>,<span class="string">'w'</span>))</span><br><span class="line">    ...:     <span class="keyword">print</span> (<span class="string">"%d:%d"</span> %(i,list_f[i].fileno()))</span><br><span class="line">    ...:</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1010:1022</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">IOError                                   Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-10-dd5ee4024396&gt; in &lt;module&gt;()</span><br><span class="line">      1 for i in range(1025):</span><br><span class="line">----&gt; 2     list_f.append(open(&quot;mtianyan.txt&quot;,&apos;w&apos;))</span><br><span class="line">      3     print (&quot;%d:%d&quot; %(i,list_f[i].fileno()))</span><br><span class="line">      4 </span><br><span class="line"></span><br><span class="line">IOError: [Errno 24] Too many open files: &apos;mtianyan.txt&apos;</span><br></pre></td></tr></table></figure><p>因此我们需要养成<strong>良好编码习惯记得关闭文件。</strong></p><h2 id="文件指针。"><a href="#文件指针。" class="headerlink" title="文件指针。"></a>文件指针。</h2><ol><li>写入文件后，必须打开才能读取写入的内容</li><li>读取文件后，无法重新再次读取读取过的内容</li></ol><p>比如：写完文件必须关闭才能读到我们写入的内容。</p><p>文件指针用于定位我们当前文件所执行到的位置：</p><ul><li>使用<code>open()</code>打开时文件指针就在起始位置。</li><li><code>read(3)</code>文件指针就会往后挪<code>3</code>个位置。指向<code>第四个位置</code>。</li><li><code>write(&#39;mtianyan&#39;)</code>就会从当前文件指针<code>4</code>开始写。文件指针就会移动<code>8个字节</code>。</li></ul><p>我们之前的问题都是因为我们无法使文件指针归于起始位置的，<br>下面我们学习自由操作文件指针：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">seek(offset[,whence]):移动文件指针</span><br><span class="line">	offset 偏移量，可以为负数</span><br><span class="line">	whence：偏移相对位置：</span><br><span class="line">os.SEEK_SET:相对文件的起始位置<span class="number">0</span></span><br><span class="line">os,SEEK_CUR:相对文件的当前位置<span class="number">1</span></span><br><span class="line">os.SEEK_END:相对文件的结尾位置<span class="number">2</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: f = open(<span class="string">'mtianyan.txt'</span>,<span class="string">'r+'</span>)</span><br><span class="line">In [<span class="number">2</span>]: <span class="keyword">import</span> os</span><br><span class="line">In [<span class="number">3</span>]: f.tell() </span><br><span class="line">Out[<span class="number">3</span>]: <span class="number">0</span></span><br></pre></td></tr></table></figure><p><code>f.tell()</code>（函数）返回当前文件的偏移返回的是一个整数，也许是一个长整数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">4</span>]: f.read(<span class="number">3</span>)</span><br><span class="line">Out[<span class="number">4</span>]: <span class="string">'tes'</span></span><br><span class="line">In [<span class="number">5</span>]: f.tell()</span><br><span class="line">Out[<span class="number">5</span>]: <span class="number">3</span></span><br><span class="line">In [<span class="number">6</span>]: f.seek(<span class="number">0</span>, os.SEEK_SET)</span><br><span class="line">In [<span class="number">7</span>]: f.tell()</span><br><span class="line">Out[<span class="number">7</span>]: <span class="number">0</span></span><br></pre></td></tr></table></figure><p>可以看出我们可以使用<code>f.seek(0, os.SEEK_SET)</code>来进行指针归零。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">8</span>]: f.seek(<span class="number">0</span>,os.SEEK_END)</span><br><span class="line">In [<span class="number">9</span>]: f.tell()</span><br><span class="line">Out[<span class="number">9</span>]: <span class="number">3139</span></span><br><span class="line">In [<span class="number">10</span>]: ls -l mtianyan.txt</span><br><span class="line">-rw-r--r-- <span class="number">1</span> mtianyan mtianyan <span class="number">3139</span> <span class="number">1</span>月   <span class="number">6</span> <span class="number">03</span>:<span class="number">58</span> mtianyan.txt</span><br><span class="line">In [<span class="number">11</span>]: f.read(<span class="number">5</span>)</span><br><span class="line">Out[<span class="number">11</span>]: <span class="string">''</span></span><br></pre></td></tr></table></figure><p>当然我们也可以把文件指针指到末尾去。文件指针已经在末尾了，向后继续读取会为空。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">12</span>]: f.seek(<span class="number">-5</span>,os.SEEK_END)</span><br><span class="line">In [<span class="number">13</span>]: f.read(<span class="number">5</span>)</span><br><span class="line">Out[<span class="number">13</span>]: <span class="string">'231\n\n'</span></span><br></pre></td></tr></table></figure><p>使用<code>f.seek(-5,os.SEEK_END)</code>可以将文件指针<strong>倒着</strong>移回去。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">In [14]: f.tell()</span><br><span class="line">Out[14]: 3139</span><br><span class="line">In [15]: f.seek(-5,os.SEEK_CUR)</span><br><span class="line">In [16]: f.tell()</span><br><span class="line">Out[16]: 3134</span><br></pre></td></tr></table></figure><p>读取<code>5</code>个之后，指针又跑到了<code>3139</code>：使用<code>f.seek(-5,os.SEEK_CUR)</code><br>又可以从当前位置往前移。</p><p>当文件<strong>偏移大于文件长度会</strong>出现的问题：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">In [17]: f.seek(0,os.SEEK_END)</span><br><span class="line">In [18]: f.tell()</span><br><span class="line">Out[18]: 3139</span><br><span class="line">In [19]: f.seek(-3140,os.SEEK_END)</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">IOError                                   Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-19-331d0bc629ca&gt; in &lt;module&gt;()</span><br><span class="line">----&gt; 1 f.seek(-3140,os.SEEK_END)</span><br><span class="line"></span><br><span class="line">IOError: [Errno 22] Invalid argument</span><br></pre></td></tr></table></figure><p>会报错：告诉我们这是一个<strong>无效的参数。</strong>类似于索引越界等。</p><h1 id="文件属性及OS模块使用"><a href="#文件属性及OS模块使用" class="headerlink" title="文件属性及OS模块使用"></a>文件属性及OS模块使用</h1><p>讲解文件属性、标准文件、文件命令行参数、文件编码格式、使用os模块中方法对文件进行操作、使用os模块中的方法对目录进行操作</p><h2 id="文件属性编码格式"><a href="#文件属性编码格式" class="headerlink" title="文件属性编码格式"></a>文件属性编码格式</h2><h3 id="Python文件属性"><a href="#Python文件属性" class="headerlink" title="Python文件属性"></a>Python文件属性</h3><ul><li><code>file.fileno()</code>:文件描述符；每打开一个就会加1，直到1024失败</li><li><code>file.mode:</code>文件打开权限</li><li><code>file.encoding:</code>文件编码格式</li><li><code>file.closed:</code>文件是否关闭</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">20</span>]: f.fileno()</span><br><span class="line">Out[<span class="number">20</span>]: <span class="number">12</span></span><br><span class="line">In [<span class="number">21</span>]: f.closed</span><br><span class="line">Out[<span class="number">21</span>]: <span class="keyword">False</span></span><br><span class="line">In [<span class="number">22</span>]: f.mode</span><br><span class="line">Out[<span class="number">22</span>]: <span class="string">'r+'</span></span><br><span class="line">In [<span class="number">23</span>]: f.encoding</span><br></pre></td></tr></table></figure><p>没有返回值：为<code>ASCII</code>码文件。应该与系统相关。</p><h3 id="Python标准文件"><a href="#Python标准文件" class="headerlink" title="Python标准文件"></a>Python标准文件</h3><ul><li>文件标准输入：<code>sys.stdin</code>；</li><li>文件标准输出：<code>sys.stdout</code>；</li><li>文件标准错误：<code>sys.stderr</code>;</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">26</span>]: <span class="keyword">import</span> sys</span><br><span class="line">In [<span class="number">27</span>]: type(sys.stdin)</span><br><span class="line">Out[<span class="number">27</span>]: file</span><br><span class="line">In [<span class="number">28</span>]: sys.stdin.mode</span><br><span class="line">Out[<span class="number">28</span>]: <span class="string">'r'</span></span><br><span class="line">In [<span class="number">29</span>]: sys.stdin.read()</span><br></pre></td></tr></table></figure><p>系统的<code>sys.stdin</code>的<code>read()</code>是指从控制台读入数据。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [32]: sys.stdin.fileno()</span><br><span class="line">Out[32]: 0</span><br></pre></td></tr></table></figure><p>系统的<code>sys.stdin</code>的<code>fileno</code>为0。也就是我们启动一个进程，他<strong>首先</strong>会<strong>打开标准输入</strong>：从控制台读数据。</p><p><code>a = raw_input()</code> 其实内部是调用<code>sys.stdin</code>来读取数据的。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [37]: sys.stdout.mode</span><br><span class="line">Out[37]: &apos;w&apos;</span><br><span class="line">In [38]: sys.stdout.write(&quot;1000&quot;)</span><br><span class="line">1000</span><br></pre></td></tr></table></figure><p><code>sys.stdout</code>只可以写，不可以读。写入相当于<strong>写入到控制台，会直接显示</strong>。</p><p><code>print</code>实际内部调用的是<code>stdout</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [39]: sys.stdout.fileno()</span><br><span class="line">Out[39]: 1</span><br></pre></td></tr></table></figure><p><code>sys.stdout</code>是系统在启动程序时<strong>第二个</strong>打开的。</p><p>也就是系统会先为我们<strong>打开输入</strong>，<strong>再打开输出</strong>。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">40</span>]: sys.stderr.mode</span><br><span class="line">Out[<span class="number">40</span>]: <span class="string">'w'</span></span><br><span class="line">In [<span class="number">41</span>]: sys.stderr.write(<span class="string">"error"</span>)</span><br><span class="line">error</span><br><span class="line">In [<span class="number">42</span>]: sys.stderr.fileno()</span><br><span class="line">Out[<span class="number">42</span>]: <span class="number">2</span></span><br></pre></td></tr></table></figure><p><code>sys.stderr</code>是系统在启动程序时第二个打开的。<br><strong>先开输入，再开输出。第三err输出。</strong></p><h3 id="Python文件命令行参数"><a href="#Python文件命令行参数" class="headerlink" title="Python文件命令行参数"></a>Python文件命令行参数</h3><p><code>sys</code>模块提供了<code>sys.argv</code>，通过该属性可以得到命令行参数</p><p>很多程序都是这么做的：比如加上<code>-v</code>,根据<strong>不同的参数完成不同的功能。</strong></p><p><code>sys.argv</code>是一个字符串组成的列表</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    print len(sys.argv)</span><br><span class="line">    for arg in sys.argv:</span><br><span class="line">        print arg</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">D:\mtianBlog\hexoBlog-Github\source\_posts\test.py</span><br></pre></td></tr></table></figure><p>直接运行,我们没有提供参数，打印出了当前文件的绝对路径文件名。</p><h3 id="Python文件编码方式。"><a href="#Python文件编码方式。" class="headerlink" title="Python文件编码方式。"></a>Python文件编码方式。</h3><p>使用普通方式打开文件：写入<code>u天涯明月笙</code>。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [3]: f.write(u&apos;天涯明月笙&apos;)</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">UnicodeEncodeError                        Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-3-3cd15b559bd9&gt; in &lt;module&gt;()</span><br><span class="line">----&gt; 1 f.write(u&apos;天涯明月笙&apos;)</span><br><span class="line"></span><br><span class="line">UnicodeEncodeError: &apos;ascii&apos; codec can&apos;t encode characters in position 0-4: ordinal not in range(128)</span><br></pre></td></tr></table></figure><p>会报错：<code>UnicodeEncodeError</code>因为我们的文件是<code>ascii</code>格式的。不能将<code>Unicode</code>字符串写入。</p><p>实现代码:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: a = unicode.encode(<span class="string">u'天涯'</span>,<span class="string">'utf-8'</span>)</span><br><span class="line">In [<span class="number">2</span>]: a</span><br><span class="line">Out[<span class="number">2</span>]: <span class="string">'\xe5\xa4\xa9\xe6\xb6\xaf'</span></span><br><span class="line">In [<span class="number">3</span>]: f.write(a)</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [7]: cat mtianyan.txt</span><br><span class="line">天涯</span><br></pre></td></tr></table></figure><p>我们可以用<code>codecs</code>模块提供方法创建制定编码格式文件.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line">f = codecs.open(<span class="string">'test.txt'</span>,<span class="string">'w'</span>,<span class="string">'utf-8'</span>)</span><br><span class="line">f.encoding</span><br></pre></td></tr></table></figure><p><code>open(fname,mode,encoding,errors,buffering):</code>使用指定编码格式打开文件</p><h2 id="linux文件系统"><a href="#linux文件系统" class="headerlink" title="linux文件系统"></a>linux文件系统</h2><p><strong>所有</strong>设备都可以看为文件:</p><ul><li>包括磁盘(ext2,ext4)文件,NFS文件系统，各种外设</li></ul><p><img src="http://myphoto.mtianyan.cn/blog/180106/12m2BBaiD8.png?imageslim" alt="mark"></p><p><code>虚拟文件系统</code>为文件提供<code>文件节点</code></p><p>每一个外设在内核中都有一个对应的<strong>驱动程序</strong>。通过<strong>系统调用</strong>对文件节点进行访问。把所有外设作为文件处理。</p><p><img src="http://myphoto.mtianyan.cn/blog/180106/f5HcLchgiF.png?imageslim" alt="mark"></p><p>在操作系统之上的Python解释器,Python程序跑在解释器中。</p><p><img src="http://myphoto.mtianyan.cn/blog/180106/I0167hf15I.png?imageslim" alt="mark"></p><p>使用<code>open()</code>会访问<code>文件节点</code>。设备节点对应虚拟文件系统的方法，这个文件系统与驱动绑定。<br>驱动会操作硬件设备。</p><h2 id="os模块对文件和目录进行操作"><a href="#os模块对文件和目录进行操作" class="headerlink" title="os模块对文件和目录进行操作"></a>os模块对文件和目录进行操作</h2><p>使用os模块来打开文件：</p><p><code>os.open(filename, flag [,mode])</code>打开文件</p><pre><code>- os.O_CREAT:创建文件
- os.O_RDONLY:只读方式打开
- os.O_WRONLY:只写方式打开
- os.O_RDWR:读写方式打开
</code></pre><p><code>os.read(fd, buffersize)</code>:读取文件，返回值为读取的内容<br><code>os.write(fd, string)</code>:写入文件 ,返回值是写入数据的大小<br><code>os.lseek(fd, pos, how)</code>: 文件指针操作<br><code>os.close(fd)</code>:关闭文件</p><p><code>umask</code>获取系统的默认权限。我的是<code>0022</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">14</span>]:fd = os.open(<span class="string">'mtianyan.txt'</span>,os.O_CREAT | os.O_RDWR)</span><br><span class="line">In [<span class="number">15</span>]: n = os.write(fd,<span class="string">"mtianyan"</span>)</span><br><span class="line">In [<span class="number">16</span>]: n</span><br><span class="line">Out[<span class="number">16</span>]: <span class="number">8</span></span><br><span class="line">In [<span class="number">17</span>]: os.lseek(fd,<span class="number">0</span>,os.SEEK_SET)</span><br><span class="line">Out[<span class="number">17</span>]: <span class="number">0</span></span><br><span class="line">In [<span class="number">18</span>]: os.read(fd,<span class="number">5</span>)</span><br><span class="line">Out[<span class="number">18</span>]: <span class="string">'mtian'</span></span><br><span class="line">Out[<span class="number">19</span>]: os.close()</span><br></pre></td></tr></table></figure><p>使用os是为了跨平台。</p><h3 id="os方法"><a href="#os方法" class="headerlink" title="os方法"></a>os方法</h3><table><thead><tr><th>os方法</th><th>说明</th></tr></thead><tbody><tr><td>os.access(path, mode)</td><td>判断该文件权限：F_OK存在,权限:R_OK ,W_OK, X_OK</td></tr><tr><td>os.listdir(path)</td><td>返回当path路径下所有文件名组成的列表</td></tr><tr><td>os.remove(path)</td><td>删除文件</td></tr><tr><td>os.rename(old, new)</td><td>修改文件或者目录名</td></tr><tr><td>os.mkdir(path[, mode])</td><td>创建目录</td></tr><tr><td>os.makedirs(path[, mode])</td><td>创建多级目录</td></tr><tr><td>os.removedirs(path)</td><td>删除多级目录</td></tr><tr><td>os.rmdir(path)</td><td>删除目录(目录必须空目录)</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">os.access(&apos;mtianyan,txt&apos;,os.R_OK)</span><br><span class="line">os.listdir(&apos;./&apos;)</span><br><span class="line">os.rename(&apos;test/&apos;,&apos;test1&apos;)</span><br></pre></td></tr></table></figure><h3 id="os-path方法"><a href="#os-path方法" class="headerlink" title="os.path方法"></a>os.path方法</h3><table><thead><tr><th>os.path方法</th><th>说明</th></tr></thead><tbody><tr><td>os.path.exists(path)</td><td>当前路径是否存在,也可以判断是否有该文件</td></tr><tr><td>os.path.isdir(s)</td><td>是否是一个目录</td></tr><tr><td>os.path.isfile(path)</td><td>是否是一个文件</td></tr><tr><td>os.path.getsize(filename)</td><td>返回文件大小，返回目录文件大小</td></tr><tr><td>os.path.dirname(p)</td><td>返回路径的目录</td></tr><tr><td>os.path.basename(p)</td><td>返回路径的文件名</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">os.path.exists(&apos;./mtianyan.txt&apos;)</span><br><span class="line"># True</span><br><span class="line">os.path.isdir(&apos;./&apos;&apos;)</span><br><span class="line"># True</span><br><span class="line">os.path.isdir(&apos;mtianyan.txt&apos;)</span><br><span class="line"># False</span><br><span class="line">os.path.isfile(&apos;mtianyan.txt&apos;)</span><br><span class="line"># True</span><br></pre></td></tr></table></figure><h1 id="文件练习"><a href="#文件练习" class="headerlink" title="文件练习"></a>文件练习</h1><p>使用Python来管理<code>ini</code>文件：实现<code>查询</code>，<code>添加</code>，<code>删除</code>，<code>保存</code>。</p><ul><li>掌握文件的基本操作</li><li>认识<code>ini</code>文件</li><li>了解<code>ConfigPaser</code></li></ul><h2 id="ini配置文件格式："><a href="#ini配置文件格式：" class="headerlink" title="ini配置文件格式："></a>ini配置文件格式：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">节： [session]</span><br><span class="line">参数(键=值)  name=value</span><br><span class="line"></span><br><span class="line">[port]</span><br><span class="line">	port1 = 800</span><br><span class="line">	port2 = 900</span><br></pre></td></tr></table></figure><p>定位带<code>port</code>这个节，然后找到。</p><h2 id="ConfigParser"><a href="#ConfigParser" class="headerlink" title="ConfigParser"></a>ConfigParser</h2><p>mtianyan.txt内容:<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[userinfo]</span><br><span class="line">name = mtianyan</span><br><span class="line">pwd = abc</span><br><span class="line"></span><br><span class="line">[study]</span><br><span class="line">python = 15</span><br><span class="line">java_base = 20</span><br></pre></td></tr></table></figure><p></p><p>两个概念：<code>sections(大的分类)</code>和<code>option小的选项</code><br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ConfigParser</span><br><span class="line">cfg = ConfigParser.ConfigParser()</span><br><span class="line"></span><br><span class="line">help(cfg.read)</span><br><span class="line"></span><br><span class="line">cfg.read(<span class="string">'mtianyan.txt'</span>)</span><br><span class="line"><span class="comment"># ['mtianyan.txt']</span></span><br><span class="line">cfg.sections() <span class="comment">#返回节点值：userinfo，study</span></span><br><span class="line"><span class="comment"># ['userinfo', 'study']</span></span><br><span class="line"><span class="keyword">for</span> se <span class="keyword">in</span> cfg.sections():</span><br><span class="line">	<span class="keyword">print</span> se</span><br><span class="line">	<span class="keyword">print</span> cfg.items(se)</span><br><span class="line"><span class="comment">#遍历出整个文件</span></span><br></pre></td></tr></table></figure><p></p><p>遍历结果如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">userinfo</span><br><span class="line">[(<span class="string">'name'</span>, <span class="string">'johntian'</span>), (<span class="string">'pwd'</span>, <span class="string">'abc'</span>)]</span><br><span class="line">study</span><br><span class="line">[(<span class="string">'python_base'</span>, <span class="string">'15'</span>), (<span class="string">'python_junior'</span>, <span class="string">'20'</span>), (<span class="string">'linux_base_'</span>, <span class="string">'15'</span>)]</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cfg.set(<span class="string">'userinfo'</span>, <span class="string">'pwd'</span>, <span class="string">'1234567'</span>)     <span class="comment">#修改键值</span></span><br><span class="line">cg.set(<span class="string">'userinfo'</span>,<span class="string">'email'</span>,<span class="string">'1147727180.com'</span>)//增加键值</span><br><span class="line"></span><br><span class="line">cfg.remove_option(<span class="string">'user info'</span>,<span class="string">'email'</span>)  //删除键值</span><br></pre></td></tr></table></figure><h2 id="文件操作练习"><a href="#文件操作练习" class="headerlink" title="文件操作练习"></a>文件操作练习</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> ConfigParser</span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">1: dump ini</span></span><br><span class="line"><span class="string">2: del section</span></span><br><span class="line"><span class="string">3: del item</span></span><br><span class="line"><span class="string">4: modify item</span></span><br><span class="line"><span class="string">5: add section</span></span><br><span class="line"><span class="string">6: save modify</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">student_info</span><span class="params">(object)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, recordfile)</span>:</span></span><br><span class="line">        self.logfile = recordfile</span><br><span class="line">        self.cfg = ConfigParser.ConfigParser()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cfg_load</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.cfg.read(self.logfile)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cfg_dump</span><span class="params">(self)</span>:</span></span><br><span class="line">        se_list = self.cfg.sections()</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"**********************&gt;"</span></span><br><span class="line">        <span class="keyword">for</span> se <span class="keyword">in</span> se_list:</span><br><span class="line">            <span class="keyword">print</span> se</span><br><span class="line">            <span class="keyword">print</span> self.cfg.items(se)</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"&lt;*********************"</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">delete_item</span><span class="params">(self, section, key)</span>:</span></span><br><span class="line">        self.cfg.remove_option(section, key)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">delete_section</span><span class="params">(self, sescion)</span>:</span></span><br><span class="line">        self.cfg.remove_option(section)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_section</span><span class="params">(self, section)</span>:</span></span><br><span class="line">        self.cfg.add_section(section)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_item</span><span class="params">(self, section, key, value)</span>:</span></span><br><span class="line">        self.cfg.set(section, key, value)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">save</span><span class="params">(self)</span>:</span></span><br><span class="line">        fp = open(self.logfile, <span class="string">'w'</span>)</span><br><span class="line">        self.cfg.write(fp)</span><br><span class="line">        fp.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    info = student_info(<span class="string">'mtianyan.txt'</span>)</span><br><span class="line">    info.cfg_load()</span><br><span class="line">    info.cfg_dump()</span><br><span class="line">    info.add_section(<span class="string">'userinfo'</span>)</span><br><span class="line">    info.set_item(<span class="string">'userinfo'</span>, <span class="string">'pwd'</span>, <span class="string">'abc'</span>)</span><br><span class="line">    info.cfg_dump()</span><br><span class="line">    info.add_section(<span class="string">'login'</span>)</span><br><span class="line">    info.set_item(<span class="string">'login'</span>, <span class="string">'2018-0106'</span>, <span class="string">'20'</span>)</span><br><span class="line">    info.cfg_dump()</span><br><span class="line">    info.save()</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">**********************&gt;</span><br><span class="line">**********************&gt;</span><br><span class="line">userinfo</span><br><span class="line">[(&apos;pwd&apos;, &apos;abc&apos;)]</span><br><span class="line">&lt;*********************</span><br><span class="line">**********************&gt;</span><br><span class="line">userinfo</span><br><span class="line">[(&apos;pwd&apos;, &apos;abc&apos;)]</span><br><span class="line">&lt;*********************</span><br><span class="line">login</span><br><span class="line">[(&apos;2018-0106&apos;, &apos;20&apos;)]</span><br><span class="line">&lt;*********************</span><br><span class="line">[Finished in 0.3s]</span><br></pre></td></tr></table></figure></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><div><div class="my_post_copyright"><script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script><script src="https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script><script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script><p><span>本文标题:</span><a href="/post/deaf66c8.html">Python文件处理-专题笔记</a></p><p><span>文章作者:</span><a href="/" title="访问 mtianyan 的个人博客">mtianyan</a></p><p><span>发布时间:</span>2018年01月05日 - 23:01</p><p><span>最后更新:</span>2018年02月02日 - 20:02</p><p><span>原始链接:</span><a href="/post/deaf66c8.html" title="Python文件处理-专题笔记">http://blog.mtianyan.cn/post/deaf66c8.html</a><span class="copy-path" title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="http://blog.mtianyan.cn/post/deaf66c8.html" aria-label="复制成功！"></i></span></p><p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p></div><script>var clipboard=new Clipboard(".fa-clipboard");$(".fa-clipboard").click(function(){clipboard.on("success",function(){swal({title:"",text:"复制成功",icon:"success",showConfirmButton:!0})})})</script></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>请博主吃包辣条</div> <button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'> <span>打赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"> <img id="wechat_qr" src="/images/wechatpay.png" alt="mtianyan 微信支付"><p>微信支付</p></div><div id="alipay" style="display:inline-block"> <img id="alipay_qr" src="/images/alipay.jpg" alt="mtianyan 支付宝"><p>支付宝</p></div></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Python/" rel="tag"><i class="fa fa-tag"></i> Python</a><a href="/tags/文件处理/" rel="tag"><i class="fa fa-tag"></i> 文件处理</a><a href="/tags/专题笔记/" rel="tag"><i class="fa fa-tag"></i> 专题笔记</a></div><div class="post-widgets"><div id="needsharebutton-postbottom"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/post/90a759d5.html" rel="next" title="用TravisCI持续集成自动部署Hexo博客的个人实践"><i class="fa fa-chevron-left"></i> 用TravisCI持续集成自动部署Hexo博客的个人实践</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/post/e4b77eed.html" rel="prev" title="强力Django+杀手级Xadmin打造在线教育平台(一)">强力Django+杀手级Xadmin打造在线教育平台(一)<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"><div class="jiathis_style"> <span class="jiathis_txt">分享到：</span> <a class="jiathis_button_fav">收藏夹</a> <a class="jiathis_button_copy">复制网址</a> <a class="jiathis_button_email">邮件</a> <a class="jiathis_button_weixin">微信</a> <a class="jiathis_button_qzone">QQ空间</a> <a class="jiathis_button_tqq">腾讯微博</a> <a class="jiathis_button_douban">豆瓣</a> <a class="jiathis_button_share">一键分享</a> <a href="http://www.jiathis.com/share?uid=2140465" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a><a class="jiathis_counter_style"></a></div><script type="text/javascript">var jiathis_config={data_track_clickback:!0,summary:"",shortUrl:!1,hideMore:!1}</script><script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=2154292" charset="utf-8"></script></div></div></div><div class="comments" id="comments"><div id="SOHUCS"></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="mtianyan"><p class="site-author-name" itemprop="name">mtianyan</p><p class="site-description motion-element" itemprop="description">爱分享，爱技术，爱生活。</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">37</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/index.html"><span class="site-state-item-count">5</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">23</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/mtianyan" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="https://www.jianshu.com/u/db9a7a0daa1f" target="_blank" title="简书"><i class="fa fa-fw fa-book"></i> 简书</a></span><span class="links-of-author-item"><a href="https://plus.google.com/u/0/114963812195952881148" target="_blank" title="Google"><i class="fa fa-fw fa-google"></i> Google</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> 友情链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="http://mtianyan.gitee.io/" title="本站孪生站(国内码云托管)" target="_blank">本站孪生站(国内码云托管)</a></li></ul></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#文件简介"><span class="nav-number">1.</span> <span class="nav-text">文件简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#文件基础操作"><span class="nav-number">2.</span> <span class="nav-text">文件基础操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#文件打开方式"><span class="nav-number">2.1.</span> <span class="nav-text">文件打开方式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#open"><span class="nav-number">2.1.1.</span> <span class="nav-text">open()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#read"><span class="nav-number">2.1.2.</span> <span class="nav-text">read()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#readline"><span class="nav-number">2.1.3.</span> <span class="nav-text">readline()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#readlines"><span class="nav-number">2.1.4.</span> <span class="nav-text">readlines()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#write"><span class="nav-number">2.1.5.</span> <span class="nav-text">write()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#writelines"><span class="nav-number">2.1.6.</span> <span class="nav-text">writelines()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#练习-39-r-39-39-w-39-39-a-39-39-r-39"><span class="nav-number">2.1.7.</span> <span class="nav-text">练习&#39;r&#39; &#39;w&#39; &#39;a&#39; &#39;r+&#39;</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#文件读取方式"><span class="nav-number">2.2.</span> <span class="nav-text">文件读取方式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#read-1"><span class="nav-number">2.2.1.</span> <span class="nav-text">read()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#readline-1"><span class="nav-number">2.2.2.</span> <span class="nav-text">readline()</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#示例操作"><span class="nav-number">2.2.2.1.</span> <span class="nav-text">示例操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#readlines-1"><span class="nav-number">2.2.3.</span> <span class="nav-text">readlines()</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#示例操作："><span class="nav-number">2.2.3.1.</span> <span class="nav-text">示例操作：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Linux命令使用"><span class="nav-number">2.2.3.2.</span> <span class="nav-text">Linux命令使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#iter-使用迭代器读取文件"><span class="nav-number">2.2.3.3.</span> <span class="nav-text">iter: 使用迭代器读取文件</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#文件写入与写缓存"><span class="nav-number">2.3.</span> <span class="nav-text">文件写入与写缓存</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#write-1"><span class="nav-number">2.3.1.</span> <span class="nav-text">write()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#writelines-1"><span class="nav-number">2.3.2.</span> <span class="nav-text">writelines()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实际操作"><span class="nav-number">2.3.3.</span> <span class="nav-text">实际操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#实际操作-1"><span class="nav-number">2.3.3.1.</span> <span class="nav-text">实际操作</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#文件关闭"><span class="nav-number">2.4.</span> <span class="nav-text">文件关闭</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#文件指针。"><span class="nav-number">2.5.</span> <span class="nav-text">文件指针。</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#文件属性及OS模块使用"><span class="nav-number">3.</span> <span class="nav-text">文件属性及OS模块使用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#文件属性编码格式"><span class="nav-number">3.1.</span> <span class="nav-text">文件属性编码格式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Python文件属性"><span class="nav-number">3.1.1.</span> <span class="nav-text">Python文件属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Python标准文件"><span class="nav-number">3.1.2.</span> <span class="nav-text">Python标准文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Python文件命令行参数"><span class="nav-number">3.1.3.</span> <span class="nav-text">Python文件命令行参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Python文件编码方式。"><span class="nav-number">3.1.4.</span> <span class="nav-text">Python文件编码方式。</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#linux文件系统"><span class="nav-number">3.2.</span> <span class="nav-text">linux文件系统</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#os模块对文件和目录进行操作"><span class="nav-number">3.3.</span> <span class="nav-text">os模块对文件和目录进行操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#os方法"><span class="nav-number">3.3.1.</span> <span class="nav-text">os方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#os-path方法"><span class="nav-number">3.3.2.</span> <span class="nav-text">os.path方法</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#文件练习"><span class="nav-number">4.</span> <span class="nav-text">文件练习</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ini配置文件格式："><span class="nav-number">4.1.</span> <span class="nav-text">ini配置文件格式：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ConfigParser"><span class="nav-number">4.2.</span> <span class="nav-text">ConfigParser</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#文件操作练习"><span class="nav-number">4.3.</span> <span class="nav-text">文件操作练习</span></a></li></ol></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright">&copy; 2015 &mdash; <span itemprop="copyrightYear">2018</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">mtianyan</span><div class="theme-info"><div class="powered-by"></div> <span class="post-count">博客全站共182.8k字</span></div></div><div class="busuanzi-count"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script> <span class="site-uv">本站访客数<span class="busuanzi-value" id="busuanzi_value_site_uv"></span> 人次</span> <span class="site-pv">本站总访问量<span class="busuanzi-value" id="busuanzi_value_site_pv"></span> 次</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div><div id="needsharebutton-float"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script><script type="text/javascript">!function(){var t="1eb79150519fd9b791c77e8eef6f3632";if((window.innerWidth||document.documentElement.clientWidth)<960)window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=cyrJmJ3rL&conf='+t+'"><\/script>');else{!function(t,e){var n=document.getElementsByTagName("head")[0]||document.head||document.documentElement,a=document.createElement("script");a.setAttribute("type","text/javascript"),a.setAttribute("charset","UTF-8"),a.setAttribute("src",t),"function"==typeof e&&(window.attachEvent?a.onreadystatechange=function(){var t=a.readyState;"loaded"!==t&&"complete"!==t||(a.onreadystatechange=null,e())}:a.onload=e),n.appendChild(a)}("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:"cyrJmJ3rL",conf:t})})}}()</script><script type="text/javascript" src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js"></script><script type="text/javascript">var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")};function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){var r=!1,s=0,a=0,i=n.title.trim(),c=i.toLowerCase(),l=n.content.trim().replace(/<[^>]+>/g,""),h=l.toLowerCase(),p=decodeURIComponent(n.url),u=[],f=[];if(""!=i&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}u=u.concat(e(t,c,!1)),f=f.concat(e(t,h,!1))}),(u.length>0||f.length>0)&&(r=!0,s=u.length+f.length)),r){[u,f].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});function d(e,o,n,r){for(var s=r[r.length-1],i=s.position,c=s.word,l=[],h=0;i+c.length<=n&&0!=r.length;){c===t&&h++,l.push({position:i,length:c.length});var p=i+c.length;for(r.pop();0!=r.length&&(i=(s=r[r.length-1]).position,c=s.word,p>i);)r.pop()}return a+=h,{hits:l,start:o,end:n,searchTextCount:h}}var g=[];0!=u.length&&g.push(d(0,0,i.length,u));for(var v=[];0!=f.length;){var $=f[f.length-1],C=$.position,m=$.word,x=C-20,w=C+80;x<0&&(x=0),w<C+m.length&&(w=C+m.length),w>l.length&&(w=l.length),v.push(d(0,x,w,f))}v.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var y=parseInt("1");y>=0&&(v=v.slice(0,y));function T(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var b="";0!=g.length?b+="<li><a href='"+p+"' class='search-result-title'>"+T(i,g[0])+"</a>":b+="<li><a href='"+p+"' class='search-result-title'>"+i+"</a>",v.forEach(function(t){b+="<a href='"+p+'\'><p class="search-result">'+T(l,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:a,hitCount:s,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),!1===isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){27===t.which&&$(".search-popup").is(":visible")&&onPopupClose()})</script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script><script>AV.initialize("2uqmIjYredIvFy6tEXbKG4Fj-gzGzoHsz","CWl1rE8cQlIseOg2Cq3hzxYi")</script><script>function showTime(e){var t=new AV.Query(e),n=[],o=$(".leancloud_visitors");o.each(function(){n.push($(this).attr("id").trim())}),t.containedIn("url",n),t.find().done(function(e){var t=".leancloud-visitors-count";if(0!==e.length){for(var i=0;i<e.length;i++){var s=e[i],r=s.get("url"),l=s.get("time"),c=document.getElementById(r);$(c).find(t).text(l)}for(i=0;i<n.length;i++){r=n[i],c=document.getElementById(r);var u=$(c).find(t);""==u.text()&&u.text(0)}}else o.find(t).text(0)}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(e){var t=$(".leancloud_visitors"),n=t.attr("id").trim(),o=t.attr("data-flag-title").trim(),i=new AV.Query(e);i.equalTo("url",n),i.find({success:function(t){if(t.length>0){var i=t[0];i.fetchWhenSave(!0),i.increment("time"),i.save(null,{success:function(e){$(document.getElementById(n)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var s=new e,r=new AV.ACL;r.setPublicReadAccess(!0),r.setPublicWriteAccess(!0),s.setACL(r),s.set("title",o),s.set("url",n),s.set("time",1),s.save(null,{success:function(e){$(document.getElementById(n)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):$(".post-title-link").length>1&&showTime(e)})</script><link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css"><script src="/lib/needsharebutton/needsharebutton.js"></script><script>pbOptions={},pbOptions.iconStyle="default",pbOptions.boxForm="horizontal",pbOptions.position="bottomCenter",pbOptions.networks="Weibo,Wechat,Douban,QQZone,Twitter,Facebook",new needShareButton("#needsharebutton-postbottom",pbOptions),flOptions={},flOptions.iconStyle="default",flOptions.boxForm="horizontal",flOptions.position="middleRight",flOptions.networks="Weibo,Wechat,Douban,QQZone,Twitter,Facebook",new needShareButton("#needsharebutton-float",flOptions)</script><script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script><script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script><script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><div id="hexo-helper-live2d"><canvas id="live2dcanvas" width="150" height="300"></canvas></div><style>#live2dcanvas{position:fixed;width:150px;height:300px;opacity:.7;right:-30px;z-index:999;pointer-events:none;bottom:40px}</style><script type="text/javascript" src="/live2d/device.min.js"></script><script type="text/javascript">
const loadScript = function loadScript(c,b){var a=document.createElement("script");a.type="text/javascript";"undefined"!=typeof b&&(a.readyState?a.onreadystatechange=function(){if("loaded"==a.readyState||"complete"==a.readyState)a.onreadystatechange=null,b()}:a.onload=function(){b()});a.src=c;document.body.appendChild(a)};
(function(){
  if((typeof(device) != 'undefined') && (device.mobile())){
    var trElement = document.getElementById('hexo-helper-live2d');
    trElement.parentNode.removeChild(trElement);
    return;
  }else
    if (typeof(device) === 'undefined') console.error('Cannot find current-device script.');
  loadScript("/live2d/script.js", function(){loadlive2d("live2dcanvas", "/live2d/assets/hijiki.model.json", 0.5);});
})();
</script></body></html><script type="text/javascript" src="/js/src/love.js"></script>